   1               		.file	"action_tapping.c"
   2               	__SP_H__ = 0x3e
   3               	__SP_L__ = 0x3d
   4               	__SREG__ = 0x3f
   5               	__tmp_reg__ = 0
   6               	__zero_reg__ = 1
   7               		.text
   8               	.Ltext0:
   9               		.cfi_sections	.debug_frame
  10               		.section	.text.debug_waiting_buffer,"ax",@progbits
  12               	debug_waiting_buffer:
  13               	.LFB15:
  14               		.file 1 "tmk_core/common/action_tapping.c"
   1:tmk_core/common/action_tapping.c **** #include <stdint.h>
   2:tmk_core/common/action_tapping.c **** #include <stdbool.h>
   3:tmk_core/common/action_tapping.c **** #include "action.h"
   4:tmk_core/common/action_tapping.c **** #include "action_layer.h"
   5:tmk_core/common/action_tapping.c **** #include "action_tapping.h"
   6:tmk_core/common/action_tapping.c **** #include "keycode.h"
   7:tmk_core/common/action_tapping.c **** #include "timer.h"
   8:tmk_core/common/action_tapping.c **** 
   9:tmk_core/common/action_tapping.c **** #ifdef DEBUG_ACTION
  10:tmk_core/common/action_tapping.c **** #    include "debug.h"
  11:tmk_core/common/action_tapping.c **** #else
  12:tmk_core/common/action_tapping.c **** #    include "nodebug.h"
  13:tmk_core/common/action_tapping.c **** #endif
  14:tmk_core/common/action_tapping.c **** 
  15:tmk_core/common/action_tapping.c **** #ifndef NO_ACTION_TAPPING
  16:tmk_core/common/action_tapping.c **** 
  17:tmk_core/common/action_tapping.c **** #    define IS_TAPPING() !IS_NOEVENT(tapping_key.event)
  18:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_PRESSED() (IS_TAPPING() && tapping_key.event.pressed)
  19:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_RELEASED() (IS_TAPPING() && !tapping_key.event.pressed)
  20:tmk_core/common/action_tapping.c **** #    define IS_TAPPING_KEY(k) (IS_TAPPING() && KEYEQ(tapping_key.event.key, (k)))
  21:tmk_core/common/action_tapping.c **** 
  22:tmk_core/common/action_tapping.c **** __attribute__((weak)) uint16_t get_tapping_term(uint16_t keycode) { return TAPPING_TERM; }
  23:tmk_core/common/action_tapping.c **** 
  24:tmk_core/common/action_tapping.c **** #    ifdef TAPPING_TERM_PER_KEY
  25:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < get_tapping
  26:tmk_core/common/action_tapping.c **** #    else
  27:tmk_core/common/action_tapping.c **** #        define WITHIN_TAPPING_TERM(e) (TIMER_DIFF_16(e.time, tapping_key.event.time) < TAPPING_TER
  28:tmk_core/common/action_tapping.c **** #    endif
  29:tmk_core/common/action_tapping.c **** 
  30:tmk_core/common/action_tapping.c **** #    ifdef TAPPING_FORCE_HOLD_PER_KEY
  31:tmk_core/common/action_tapping.c **** __attribute__((weak)) bool get_tapping_force_hold(uint16_t keycode, keyrecord_t *record) { return f
  32:tmk_core/common/action_tapping.c **** #    endif
  33:tmk_core/common/action_tapping.c **** 
  34:tmk_core/common/action_tapping.c **** static keyrecord_t tapping_key                         = {};
  35:tmk_core/common/action_tapping.c **** static keyrecord_t waiting_buffer[WAITING_BUFFER_SIZE] = {};
  36:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_head                 = 0;
  37:tmk_core/common/action_tapping.c **** static uint8_t     waiting_buffer_tail                 = 0;
  38:tmk_core/common/action_tapping.c **** 
  39:tmk_core/common/action_tapping.c **** static bool process_tapping(keyrecord_t *record);
  40:tmk_core/common/action_tapping.c **** static bool waiting_buffer_enq(keyrecord_t record);
  41:tmk_core/common/action_tapping.c **** static void waiting_buffer_clear(void);
  42:tmk_core/common/action_tapping.c **** static bool waiting_buffer_typed(keyevent_t event);
  43:tmk_core/common/action_tapping.c **** static bool waiting_buffer_has_anykey_pressed(void);
  44:tmk_core/common/action_tapping.c **** static void waiting_buffer_scan_tap(void);
  45:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void);
  46:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void);
  47:tmk_core/common/action_tapping.c **** 
  48:tmk_core/common/action_tapping.c **** /** \brief Action Tapping Process
  49:tmk_core/common/action_tapping.c ****  *
  50:tmk_core/common/action_tapping.c ****  * FIXME: Needs doc
  51:tmk_core/common/action_tapping.c ****  */
  52:tmk_core/common/action_tapping.c **** void action_tapping_process(keyrecord_t record) {
  53:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
  54:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
  55:tmk_core/common/action_tapping.c ****             debug("processed: ");
  56:tmk_core/common/action_tapping.c ****             debug_record(record);
  57:tmk_core/common/action_tapping.c ****             debug("\n");
  58:tmk_core/common/action_tapping.c ****         }
  59:tmk_core/common/action_tapping.c ****     } else {
  60:tmk_core/common/action_tapping.c ****         if (!waiting_buffer_enq(record)) {
  61:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
  62:tmk_core/common/action_tapping.c ****             debug("OVERFLOW: CLEAR ALL STATES\n");
  63:tmk_core/common/action_tapping.c ****             clear_keyboard();
  64:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
  65:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
  66:tmk_core/common/action_tapping.c ****         }
  67:tmk_core/common/action_tapping.c ****     }
  68:tmk_core/common/action_tapping.c **** 
  69:tmk_core/common/action_tapping.c ****     // process waiting_buffer
  70:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event) && waiting_buffer_head != waiting_buffer_tail) {
  71:tmk_core/common/action_tapping.c ****         debug("---- action_exec: process waiting_buffer -----\n");
  72:tmk_core/common/action_tapping.c ****     }
  73:tmk_core/common/action_tapping.c ****     for (; waiting_buffer_tail != waiting_buffer_head; waiting_buffer_tail = (waiting_buffer_tail +
  74:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
  75:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
  76:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
  77:tmk_core/common/action_tapping.c ****             debug("] = ");
  78:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
  79:tmk_core/common/action_tapping.c ****             debug("\n\n");
  80:tmk_core/common/action_tapping.c ****         } else {
  81:tmk_core/common/action_tapping.c ****             break;
  82:tmk_core/common/action_tapping.c ****         }
  83:tmk_core/common/action_tapping.c ****     }
  84:tmk_core/common/action_tapping.c ****     if (!IS_NOEVENT(record.event)) {
  85:tmk_core/common/action_tapping.c ****         debug("\n");
  86:tmk_core/common/action_tapping.c ****     }
  87:tmk_core/common/action_tapping.c **** }
  88:tmk_core/common/action_tapping.c **** 
  89:tmk_core/common/action_tapping.c **** /** \brief Tapping
  90:tmk_core/common/action_tapping.c ****  *
  91:tmk_core/common/action_tapping.c ****  * Rule: Tap key is typed(pressed and released) within TAPPING_TERM.
  92:tmk_core/common/action_tapping.c ****  *       (without interfering by typing other key)
  93:tmk_core/common/action_tapping.c ****  */
  94:tmk_core/common/action_tapping.c **** /* return true when key event is processed or consumed. */
  95:tmk_core/common/action_tapping.c **** bool process_tapping(keyrecord_t *keyp) {
  96:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
  97:tmk_core/common/action_tapping.c **** 
  98:tmk_core/common/action_tapping.c ****     // if tapping
  99:tmk_core/common/action_tapping.c ****     if (IS_TAPPING_PRESSED()) {
 100:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 101:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 102:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 103:tmk_core/common/action_tapping.c ****                     // first tap!
 104:tmk_core/common/action_tapping.c ****                     debug("Tapping: First tap(0->1).\n");
 105:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 106:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 107:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 108:tmk_core/common/action_tapping.c **** 
 109:tmk_core/common/action_tapping.c ****                     // copy tapping state
 110:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 111:tmk_core/common/action_tapping.c ****                     // enqueue
 112:tmk_core/common/action_tapping.c ****                     return false;
 113:tmk_core/common/action_tapping.c ****                 }
 114:tmk_core/common/action_tapping.c ****                 /* Process a key typed within TAPPING_TERM
 115:tmk_core/common/action_tapping.c ****                  * This can register the key before settlement of tapping,
 116:tmk_core/common/action_tapping.c ****                  * useful for long TAPPING_TERM but may prevent fast typing.
 117:tmk_core/common/action_tapping.c ****                  */
 118:tmk_core/common/action_tapping.c **** #    if defined(TAPPING_TERM_PER_KEY) || (TAPPING_TERM >= 500) || defined(PERMISSIVE_HOLD)
 119:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_TERM_PER_KEY
 120:tmk_core/common/action_tapping.c ****                 else if ((get_tapping_term(get_event_keycode(tapping_key.event)) >= 500) && IS_RELE
 121:tmk_core/common/action_tapping.c **** #        else
 122:tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && waiting_buffer_typed(event))
 123:tmk_core/common/action_tapping.c **** #        endif
 124:tmk_core/common/action_tapping.c ****                 {
 125:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. No tap. Interfered by typing key\n");
 126:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 127:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 128:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 129:tmk_core/common/action_tapping.c ****                     // enqueue
 130:tmk_core/common/action_tapping.c ****                     return false;
 131:tmk_core/common/action_tapping.c ****                 }
 132:tmk_core/common/action_tapping.c **** #    endif
 133:tmk_core/common/action_tapping.c ****                 /* Process release event of a key pressed before tapping starts
 134:tmk_core/common/action_tapping.c ****                  * Without this unexpected repeating will occur with having fast repeating setting
 135:tmk_core/common/action_tapping.c ****                  * https://github.com/tmk/tmk_keyboard/issues/60
 136:tmk_core/common/action_tapping.c ****                  */
 137:tmk_core/common/action_tapping.c ****                 else if (IS_RELEASED(event) && !waiting_buffer_typed(event)) {
 138:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 139:tmk_core/common/action_tapping.c ****                     action_t action = layer_switch_get_action(event.key);
 140:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 141:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 142:tmk_core/common/action_tapping.c ****                         case ACT_RMODS:
 143:tmk_core/common/action_tapping.c ****                             if (action.key.mods && !action.key.code) return false;
 144:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 145:tmk_core/common/action_tapping.c ****                             break;
 146:tmk_core/common/action_tapping.c ****                         case ACT_LMODS_TAP:
 147:tmk_core/common/action_tapping.c ****                         case ACT_RMODS_TAP:
 148:tmk_core/common/action_tapping.c ****                             if (action.key.mods && keyp->tap.count == 0) return false;
 149:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 150:tmk_core/common/action_tapping.c ****                             break;
 151:tmk_core/common/action_tapping.c ****                     }
 152:tmk_core/common/action_tapping.c ****                     // Release of key should be process immediately.
 153:tmk_core/common/action_tapping.c ****                     debug("Tapping: release event of a key pressed before tapping\n");
 154:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 155:tmk_core/common/action_tapping.c ****                     return true;
 156:tmk_core/common/action_tapping.c ****                 } else {
 157:tmk_core/common/action_tapping.c ****                     // set interrupted flag when other key preesed during tapping
 158:tmk_core/common/action_tapping.c ****                     if (event.pressed) {
 159:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 160:tmk_core/common/action_tapping.c ****                     }
 161:tmk_core/common/action_tapping.c ****                     // enqueue
 162:tmk_core/common/action_tapping.c ****                     return false;
 163:tmk_core/common/action_tapping.c ****                 }
 164:tmk_core/common/action_tapping.c ****             }
 165:tmk_core/common/action_tapping.c ****             // tap_count > 0
 166:tmk_core/common/action_tapping.c ****             else {
 167:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 168:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 169:tmk_core/common/action_tapping.c ****                     debug_dec(tapping_key.tap.count);
 170:tmk_core/common/action_tapping.c ****                     debug(")\n");
 171:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 172:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 173:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 174:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 175:tmk_core/common/action_tapping.c ****                     return true;
 176:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 177:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 178:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 179:tmk_core/common/action_tapping.c ****                         // unregister key
 180:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 181:tmk_core/common/action_tapping.c ****                     } else {
 182:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last tap(1).\n");
 183:tmk_core/common/action_tapping.c ****                     }
 184:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 185:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 186:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 187:tmk_core/common/action_tapping.c ****                     return true;
 188:tmk_core/common/action_tapping.c ****                 } else {
 189:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 190:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 191:tmk_core/common/action_tapping.c ****                     }
 192:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 193:tmk_core/common/action_tapping.c ****                     return true;
 194:tmk_core/common/action_tapping.c ****                 }
 195:tmk_core/common/action_tapping.c ****             }
 196:tmk_core/common/action_tapping.c ****         }
 197:tmk_core/common/action_tapping.c ****         // after TAPPING_TERM
 198:tmk_core/common/action_tapping.c ****         else {
 199:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 200:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 201:tmk_core/common/action_tapping.c ****                 debug_event(event);
 202:tmk_core/common/action_tapping.c ****                 debug("\n");
 203:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 204:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 205:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 206:tmk_core/common/action_tapping.c ****                 return false;
 207:tmk_core/common/action_tapping.c ****             } else {
 208:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 209:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 210:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 211:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 212:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 213:tmk_core/common/action_tapping.c ****                     return true;
 214:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 215:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 216:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 217:tmk_core/common/action_tapping.c ****                         // unregister key
 218:tmk_core/common/action_tapping.c ****                         process_record(&(keyrecord_t){.tap = tapping_key.tap, .event.key = tapping_
 219:tmk_core/common/action_tapping.c ****                     } else {
 220:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start while last timeout tap(1).\n");
 221:tmk_core/common/action_tapping.c ****                     }
 222:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 223:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 224:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 225:tmk_core/common/action_tapping.c ****                     return true;
 226:tmk_core/common/action_tapping.c ****                 } else {
 227:tmk_core/common/action_tapping.c ****                     if (!IS_NOEVENT(event)) {
 228:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last timeout tap(>0).\n");
 229:tmk_core/common/action_tapping.c ****                     }
 230:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 231:tmk_core/common/action_tapping.c ****                     return true;
 232:tmk_core/common/action_tapping.c ****                 }
 233:tmk_core/common/action_tapping.c ****             }
 234:tmk_core/common/action_tapping.c ****         }
 235:tmk_core/common/action_tapping.c ****     } else if (IS_TAPPING_RELEASED()) {
 236:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 237:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 238:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 239:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 240:tmk_core/common/action_tapping.c **** #    if !defined(TAPPING_FORCE_HOLD) || defined(TAPPING_FORCE_HOLD_PER_KEY)
 241:tmk_core/common/action_tapping.c ****                     if (
 242:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 243:tmk_core/common/action_tapping.c ****                         !get_tapping_force_hold(get_event_keycode(tapping_key.event), keyp) &&
 244:tmk_core/common/action_tapping.c **** #        endif
 245:tmk_core/common/action_tapping.c ****                         !tapping_key.tap.interrupted && tapping_key.tap.count > 0) {
 246:tmk_core/common/action_tapping.c ****                         // sequential tap.
 247:tmk_core/common/action_tapping.c ****                         keyp->tap = tapping_key.tap;
 248:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 249:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 250:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 251:tmk_core/common/action_tapping.c ****                         debug(")\n");
 252:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 253:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 254:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 255:tmk_core/common/action_tapping.c ****                         return true;
 256:tmk_core/common/action_tapping.c ****                     }
 257:tmk_core/common/action_tapping.c **** #    endif
 258:tmk_core/common/action_tapping.c ****                     // FIX: start new tap again
 259:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 260:tmk_core/common/action_tapping.c ****                     return true;
 261:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 262:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 263:tmk_core/common/action_tapping.c ****                     debug("Tapping: Start with interfering other tap.\n");
 264:tmk_core/common/action_tapping.c ****                     tapping_key = *keyp;
 265:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 266:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 267:tmk_core/common/action_tapping.c ****                     return true;
 268:tmk_core/common/action_tapping.c ****                 } else {
 269:tmk_core/common/action_tapping.c ****                     // should none in buffer
 270:tmk_core/common/action_tapping.c ****                     // FIX: interrupted when other key is pressed
 271:tmk_core/common/action_tapping.c ****                     tapping_key.tap.interrupted = true;
 272:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 273:tmk_core/common/action_tapping.c ****                     return true;
 274:tmk_core/common/action_tapping.c ****                 }
 275:tmk_core/common/action_tapping.c ****             } else {
 276:tmk_core/common/action_tapping.c ****                 if (!IS_NOEVENT(event)) debug("Tapping: other key just after tap.\n");
 277:tmk_core/common/action_tapping.c ****                 process_record(keyp);
 278:tmk_core/common/action_tapping.c ****                 return true;
 279:tmk_core/common/action_tapping.c ****             }
 280:tmk_core/common/action_tapping.c ****         } else {
 281:tmk_core/common/action_tapping.c ****             // FIX: process_action here?
 282:tmk_core/common/action_tapping.c ****             // timeout. no sequential tap.
 283:tmk_core/common/action_tapping.c ****             debug("Tapping: End(Timeout after releasing last tap): ");
 284:tmk_core/common/action_tapping.c ****             debug_event(event);
 285:tmk_core/common/action_tapping.c ****             debug("\n");
 286:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 287:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 288:tmk_core/common/action_tapping.c ****             return false;
 289:tmk_core/common/action_tapping.c ****         }
 290:tmk_core/common/action_tapping.c ****     }
 291:tmk_core/common/action_tapping.c ****     // not tapping state
 292:tmk_core/common/action_tapping.c ****     else {
 293:tmk_core/common/action_tapping.c ****         if (event.pressed && is_tap_key(event.key)) {
 294:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 295:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 296:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 297:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 298:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 299:tmk_core/common/action_tapping.c ****             return true;
 300:tmk_core/common/action_tapping.c ****         } else {
 301:tmk_core/common/action_tapping.c ****             process_record(keyp);
 302:tmk_core/common/action_tapping.c ****             return true;
 303:tmk_core/common/action_tapping.c ****         }
 304:tmk_core/common/action_tapping.c ****     }
 305:tmk_core/common/action_tapping.c **** }
 306:tmk_core/common/action_tapping.c **** 
 307:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer enq
 308:tmk_core/common/action_tapping.c ****  *
 309:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 310:tmk_core/common/action_tapping.c ****  */
 311:tmk_core/common/action_tapping.c **** bool waiting_buffer_enq(keyrecord_t record) {
 312:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 313:tmk_core/common/action_tapping.c ****         return true;
 314:tmk_core/common/action_tapping.c ****     }
 315:tmk_core/common/action_tapping.c **** 
 316:tmk_core/common/action_tapping.c ****     if ((waiting_buffer_head + 1) % WAITING_BUFFER_SIZE == waiting_buffer_tail) {
 317:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 318:tmk_core/common/action_tapping.c ****         return false;
 319:tmk_core/common/action_tapping.c ****     }
 320:tmk_core/common/action_tapping.c **** 
 321:tmk_core/common/action_tapping.c ****     waiting_buffer[waiting_buffer_head] = record;
 322:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 323:tmk_core/common/action_tapping.c **** 
 324:tmk_core/common/action_tapping.c ****     debug("waiting_buffer_enq: ");
 325:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 326:tmk_core/common/action_tapping.c ****     return true;
 327:tmk_core/common/action_tapping.c **** }
 328:tmk_core/common/action_tapping.c **** 
 329:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer clear
 330:tmk_core/common/action_tapping.c ****  *
 331:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 332:tmk_core/common/action_tapping.c ****  */
 333:tmk_core/common/action_tapping.c **** void waiting_buffer_clear(void) {
 334:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 335:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 336:tmk_core/common/action_tapping.c **** }
 337:tmk_core/common/action_tapping.c **** 
 338:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer typed
 339:tmk_core/common/action_tapping.c ****  *
 340:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 341:tmk_core/common/action_tapping.c ****  */
 342:tmk_core/common/action_tapping.c **** bool waiting_buffer_typed(keyevent_t event) {
 343:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 344:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 345:tmk_core/common/action_tapping.c ****             return true;
 346:tmk_core/common/action_tapping.c ****         }
 347:tmk_core/common/action_tapping.c ****     }
 348:tmk_core/common/action_tapping.c ****     return false;
 349:tmk_core/common/action_tapping.c **** }
 350:tmk_core/common/action_tapping.c **** 
 351:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer has anykey pressed
 352:tmk_core/common/action_tapping.c ****  *
 353:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 354:tmk_core/common/action_tapping.c ****  */
 355:tmk_core/common/action_tapping.c **** __attribute__((unused)) bool waiting_buffer_has_anykey_pressed(void) {
 356:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 357:tmk_core/common/action_tapping.c ****         if (waiting_buffer[i].event.pressed) return true;
 358:tmk_core/common/action_tapping.c ****     }
 359:tmk_core/common/action_tapping.c ****     return false;
 360:tmk_core/common/action_tapping.c **** }
 361:tmk_core/common/action_tapping.c **** 
 362:tmk_core/common/action_tapping.c **** /** \brief Scan buffer for tapping
 363:tmk_core/common/action_tapping.c ****  *
 364:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 365:tmk_core/common/action_tapping.c ****  */
 366:tmk_core/common/action_tapping.c **** void waiting_buffer_scan_tap(void) {
 367:tmk_core/common/action_tapping.c ****     // tapping already is settled
 368:tmk_core/common/action_tapping.c ****     if (tapping_key.tap.count > 0) return;
 369:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 370:tmk_core/common/action_tapping.c ****     if (!tapping_key.event.pressed) return;
 371:tmk_core/common/action_tapping.c **** 
 372:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
 373:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 374:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 375:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 376:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 377:tmk_core/common/action_tapping.c **** 
 378:tmk_core/common/action_tapping.c ****             debug("waiting_buffer_scan_tap: found at [");
 379:tmk_core/common/action_tapping.c ****             debug_dec(i);
 380:tmk_core/common/action_tapping.c ****             debug("]\n");
 381:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 382:tmk_core/common/action_tapping.c ****             return;
 383:tmk_core/common/action_tapping.c ****         }
 384:tmk_core/common/action_tapping.c ****     }
 385:tmk_core/common/action_tapping.c **** }
 386:tmk_core/common/action_tapping.c **** 
 387:tmk_core/common/action_tapping.c **** /** \brief Tapping key debug print
 388:tmk_core/common/action_tapping.c ****  *
 389:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 390:tmk_core/common/action_tapping.c ****  */
 391:tmk_core/common/action_tapping.c **** static void debug_tapping_key(void) {
 392:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
 393:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
 394:tmk_core/common/action_tapping.c ****     debug("\n");
 395:tmk_core/common/action_tapping.c **** }
 396:tmk_core/common/action_tapping.c **** 
 397:tmk_core/common/action_tapping.c **** /** \brief Waiting buffer debug print
 398:tmk_core/common/action_tapping.c ****  *
 399:tmk_core/common/action_tapping.c ****  * FIXME: Needs docs
 400:tmk_core/common/action_tapping.c ****  */
 401:tmk_core/common/action_tapping.c **** static void debug_waiting_buffer(void) {
  15               		.loc 1 401 40 view -0
  16               		.cfi_startproc
  17 0000 CF93      		push r28
  18               	.LCFI0:
  19               		.cfi_def_cfa_offset 3
  20               		.cfi_offset 28, -2
  21 0002 DF93      		push r29
  22               	.LCFI1:
  23               		.cfi_def_cfa_offset 4
  24               		.cfi_offset 29, -3
  25               	/* prologue: function */
  26               	/* frame size = 0 */
  27               	/* stack size = 2 */
  28               	.L__stack_usage = 2
 402:tmk_core/common/action_tapping.c ****     debug("{ ");
  29               		.loc 1 402 16 view .LVU1
 403:tmk_core/common/action_tapping.c ****     for (uint8_t i = waiting_buffer_tail; i != waiting_buffer_head; i = (i + 1) % WAITING_BUFFER_SI
  30               		.loc 1 403 5 view .LVU2
  31               	.LBB3:
  32               		.loc 1 403 10 view .LVU3
  33               		.loc 1 403 18 is_stmt 0 view .LVU4
  34 0004 C091 0000 		lds r28,waiting_buffer_tail
  35               	.LVL0:
  36               	.L2:
  37               		.loc 1 403 5 discriminator 1 view .LVU5
  38 0008 8091 0000 		lds r24,waiting_buffer_head
  39 000c 8C13      		cpse r24,r28
  40 000e 00C0      		rjmp .L3
  41               	/* epilogue start */
  42               	.LBE3:
 404:tmk_core/common/action_tapping.c ****         debug("[");
 405:tmk_core/common/action_tapping.c ****         debug_dec(i);
 406:tmk_core/common/action_tapping.c ****         debug("]=");
 407:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
 408:tmk_core/common/action_tapping.c ****         debug(" ");
 409:tmk_core/common/action_tapping.c ****     }
 410:tmk_core/common/action_tapping.c ****     debug("}\n");
 411:tmk_core/common/action_tapping.c **** }
  43               		.loc 1 411 1 view .LVU6
  44 0010 DF91      		pop r29
  45 0012 CF91      		pop r28
  46               	.LVL1:
  47               		.loc 1 411 1 view .LVU7
  48 0014 0895      		ret
  49               	.LVL2:
  50               	.L3:
  51               	.LBB4:
 404:tmk_core/common/action_tapping.c ****         debug("[");
  52               		.loc 1 404 19 is_stmt 1 discriminator 3 view .LVU8
 405:tmk_core/common/action_tapping.c ****         debug("]=");
  53               		.loc 1 405 21 discriminator 3 view .LVU9
 406:tmk_core/common/action_tapping.c ****         debug_record(waiting_buffer[i]);
  54               		.loc 1 406 20 discriminator 3 view .LVU10
 407:tmk_core/common/action_tapping.c ****         debug(" ");
  55               		.loc 1 407 9 discriminator 3 view .LVU11
  56 0016 D0E0      		ldi r29,0
  57 0018 CE01      		movw r24,r28
  58 001a 66E0      		ldi r22,lo8(6)
  59 001c 70E0      		ldi r23,0
  60 001e 0E94 0000 		call __mulhi3
  61 0022 FC01      		movw r30,r24
  62 0024 E050      		subi r30,lo8(-(waiting_buffer))
  63 0026 F040      		sbci r31,hi8(-(waiting_buffer))
  64 0028 4081      		ld r20,Z
  65 002a 5181      		ldd r21,Z+1
  66 002c 6281      		ldd r22,Z+2
  67 002e 7381      		ldd r23,Z+3
  68 0030 8481      		ldd r24,Z+4
  69 0032 9581      		ldd r25,Z+5
  70 0034 0E94 0000 		call debug_record
  71               	.LVL3:
 408:tmk_core/common/action_tapping.c ****     }
  72               		.loc 1 408 19 discriminator 3 view .LVU12
 403:tmk_core/common/action_tapping.c ****         debug("[");
  73               		.loc 1 403 76 is_stmt 0 discriminator 3 view .LVU13
  74 0038 2196      		adiw r28,1
  75               	.LVL4:
 403:tmk_core/common/action_tapping.c ****         debug("[");
  76               		.loc 1 403 71 discriminator 3 view .LVU14
  77 003a C770      		andi r28,lo8(7)
 403:tmk_core/common/action_tapping.c ****         debug("[");
  78               		.loc 1 403 71 discriminator 3 view .LVU15
  79 003c 00C0      		rjmp .L2
  80               	.LBE4:
  81               		.cfi_endproc
  82               	.LFE15:
  84               		.section	.text.debug_tapping_key,"ax",@progbits
  86               	debug_tapping_key:
  87               	.LFB14:
 391:tmk_core/common/action_tapping.c ****     debug("TAPPING_KEY=");
  88               		.loc 1 391 37 is_stmt 1 view -0
  89               		.cfi_startproc
  90               	/* prologue: function */
  91               	/* frame size = 0 */
  92               	/* stack size = 0 */
  93               	.L__stack_usage = 0
 392:tmk_core/common/action_tapping.c ****     debug_record(tapping_key);
  94               		.loc 1 392 26 view .LVU17
 393:tmk_core/common/action_tapping.c ****     debug("\n");
  95               		.loc 1 393 5 view .LVU18
  96 0000 4091 0000 		lds r20,tapping_key
  97 0004 5091 0000 		lds r21,tapping_key+1
  98 0008 6091 0000 		lds r22,tapping_key+2
  99 000c 7091 0000 		lds r23,tapping_key+3
 100 0010 8091 0000 		lds r24,tapping_key+4
 101 0014 9091 0000 		lds r25,tapping_key+5
 102 0018 0C94 0000 		jmp debug_record
 103               	.LVL5:
 104               		.cfi_endproc
 105               	.LFE14:
 107               		.section	.text.waiting_buffer_scan_tap,"ax",@progbits
 109               	waiting_buffer_scan_tap:
 110               	.LFB13:
 366:tmk_core/common/action_tapping.c ****     // tapping already is settled
 111               		.loc 1 366 36 view -0
 112               		.cfi_startproc
 113 0000 FF92      		push r15
 114               	.LCFI2:
 115               		.cfi_def_cfa_offset 3
 116               		.cfi_offset 15, -2
 117 0002 0F93      		push r16
 118               	.LCFI3:
 119               		.cfi_def_cfa_offset 4
 120               		.cfi_offset 16, -3
 121 0004 1F93      		push r17
 122               	.LCFI4:
 123               		.cfi_def_cfa_offset 5
 124               		.cfi_offset 17, -4
 125 0006 CF93      		push r28
 126               	.LCFI5:
 127               		.cfi_def_cfa_offset 6
 128               		.cfi_offset 28, -5
 129 0008 DF93      		push r29
 130               	.LCFI6:
 131               		.cfi_def_cfa_offset 7
 132               		.cfi_offset 29, -6
 133               	/* prologue: function */
 134               	/* frame size = 0 */
 135               	/* stack size = 5 */
 136               	.L__stack_usage = 5
 368:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 137               		.loc 1 368 5 view .LVU20
 368:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 138               		.loc 1 368 31 is_stmt 0 view .LVU21
 139 000a 8091 0000 		lds r24,tapping_key+5
 140 000e 807F      		andi r24,lo8(-16)
 368:tmk_core/common/action_tapping.c ****     // invalid state: tapping_key released && tap.count == 0
 141               		.loc 1 368 8 view .LVU22
 142 0010 01F4      		brne .L5
 370:tmk_core/common/action_tapping.c **** 
 143               		.loc 1 370 5 is_stmt 1 view .LVU23
 370:tmk_core/common/action_tapping.c **** 
 144               		.loc 1 370 8 is_stmt 0 view .LVU24
 145 0012 8091 0000 		lds r24,tapping_key+2
 146 0016 8823      		tst r24
 147 0018 01F0      		breq .L5
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 148               		.loc 1 372 5 is_stmt 1 view .LVU25
 149               	.LBB8:
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 150               		.loc 1 372 10 view .LVU26
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 151               		.loc 1 372 18 is_stmt 0 view .LVU27
 152 001a 2091 0000 		lds r18,waiting_buffer_tail
 153               	.LVL6:
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 154               		.loc 1 372 45 view .LVU28
 155 001e 0091 0000 		lds r16,waiting_buffer_head
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 156               		.loc 1 373 13 view .LVU29
 157 0022 4091 0000 		lds r20,tapping_key
 158 0026 1091 0000 		lds r17,tapping_key+1
 159 002a E091 0000 		lds r30,tapping_key+3
 160 002e F091 0000 		lds r31,tapping_key+3+1
 161 0032 F42E      		mov r15,r20
 162 0034 F122      		and r15,r17
 163 0036 EF01      		movw r28,r30
 164 0038 C095      		com r28
 165 003a D095      		com r29
 166               	.LVL7:
 167               	.L7:
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 168               		.loc 1 372 5 discriminator 1 view .LVU30
 169 003c 0213      		cpse r16,r18
 170 003e 00C0      		rjmp .L14
 171               	.LVL8:
 172               	.L5:
 173               	/* epilogue start */
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 174               		.loc 1 372 5 discriminator 1 view .LVU31
 175               	.LBE8:
 385:tmk_core/common/action_tapping.c **** 
 176               		.loc 1 385 1 view .LVU32
 177 0040 DF91      		pop r29
 178 0042 CF91      		pop r28
 179 0044 1F91      		pop r17
 180 0046 0F91      		pop r16
 181 0048 FF90      		pop r15
 182 004a 0895      		ret
 183               	.LVL9:
 184               	.L14:
 185               	.LBB11:
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 186               		.loc 1 373 9 is_stmt 1 view .LVU33
 187               	.LBB9:
 188               	.LBI9:
 189               		.file 2 "tmk_core/common/keyboard.h"
   1:tmk_core/common/keyboard.h **** /*
   2:tmk_core/common/keyboard.h **** Copyright 2011,2012,2013 Jun Wako <wakojun@gmail.com>
   3:tmk_core/common/keyboard.h **** 
   4:tmk_core/common/keyboard.h **** This program is free software: you can redistribute it and/or modify
   5:tmk_core/common/keyboard.h **** it under the terms of the GNU General Public License as published by
   6:tmk_core/common/keyboard.h **** the Free Software Foundation, either version 2 of the License, or
   7:tmk_core/common/keyboard.h **** (at your option) any later version.
   8:tmk_core/common/keyboard.h **** 
   9:tmk_core/common/keyboard.h **** This program is distributed in the hope that it will be useful,
  10:tmk_core/common/keyboard.h **** but WITHOUT ANY WARRANTY; without even the implied warranty of
  11:tmk_core/common/keyboard.h **** MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
  12:tmk_core/common/keyboard.h **** GNU General Public License for more details.
  13:tmk_core/common/keyboard.h **** 
  14:tmk_core/common/keyboard.h **** You should have received a copy of the GNU General Public License
  15:tmk_core/common/keyboard.h **** along with this program.  If not, see <http://www.gnu.org/licenses/>.
  16:tmk_core/common/keyboard.h **** */
  17:tmk_core/common/keyboard.h **** 
  18:tmk_core/common/keyboard.h **** #ifndef KEYBOARD_H
  19:tmk_core/common/keyboard.h **** #define KEYBOARD_H
  20:tmk_core/common/keyboard.h **** 
  21:tmk_core/common/keyboard.h **** #include <stdbool.h>
  22:tmk_core/common/keyboard.h **** #include <stdint.h>
  23:tmk_core/common/keyboard.h **** 
  24:tmk_core/common/keyboard.h **** #ifdef __cplusplus
  25:tmk_core/common/keyboard.h **** extern "C" {
  26:tmk_core/common/keyboard.h **** #endif
  27:tmk_core/common/keyboard.h **** 
  28:tmk_core/common/keyboard.h **** /* key matrix position */
  29:tmk_core/common/keyboard.h **** typedef struct {
  30:tmk_core/common/keyboard.h ****     uint8_t col;
  31:tmk_core/common/keyboard.h ****     uint8_t row;
  32:tmk_core/common/keyboard.h **** } keypos_t;
  33:tmk_core/common/keyboard.h **** 
  34:tmk_core/common/keyboard.h **** /* key event */
  35:tmk_core/common/keyboard.h **** typedef struct {
  36:tmk_core/common/keyboard.h ****     keypos_t key;
  37:tmk_core/common/keyboard.h ****     bool     pressed;
  38:tmk_core/common/keyboard.h ****     uint16_t time;
  39:tmk_core/common/keyboard.h **** } keyevent_t;
  40:tmk_core/common/keyboard.h **** 
  41:tmk_core/common/keyboard.h **** /* equivalent test of keypos_t */
  42:tmk_core/common/keyboard.h **** #define KEYEQ(keya, keyb) ((keya).row == (keyb).row && (keya).col == (keyb).col)
  43:tmk_core/common/keyboard.h **** 
  44:tmk_core/common/keyboard.h **** /* Rules for No Event:
  45:tmk_core/common/keyboard.h ****  * 1) (time == 0) to handle (keyevent_t){} as empty event
  46:tmk_core/common/keyboard.h ****  * 2) Matrix(255, 255) to make TICK event available
  47:tmk_core/common/keyboard.h ****  */
  48:tmk_core/common/keyboard.h **** static inline bool IS_NOEVENT(keyevent_t event) { return event.time == 0 || (event.key.row == 255 &
 190               		.loc 2 48 20 view .LVU34
 191               	.LBB10:
 192               		.loc 2 48 51 view .LVU35
 193 004c 30E0      		ldi r19,0
 194               		.loc 2 48 74 is_stmt 0 view .LVU36
 195 004e 3097      		sbiw r30,0
 196 0050 01F0      		breq .L8
 197 0052 8FEF      		ldi r24,lo8(-1)
 198 0054 F812      		cpse r15,r24
 199 0056 00C0      		rjmp .L27
 200               	.L8:
 201               	.LBE10:
 202               	.LBE9:
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 203               		.loc 1 372 76 discriminator 2 view .LVU37
 204 0058 2F5F      		subi r18,-1
 205 005a 3F4F      		sbci r19,-1
 206               	.LVL10:
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 207               		.loc 1 372 71 discriminator 2 view .LVU38
 208 005c 2770      		andi r18,lo8(7)
 372:tmk_core/common/action_tapping.c ****         if (IS_TAPPING_KEY(waiting_buffer[i].event.key) && !waiting_buffer[i].event.pressed && WITH
 209               		.loc 1 372 71 discriminator 2 view .LVU39
 210 005e 00C0      		rjmp .L7
 211               	.LVL11:
 212               	.L10:
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 213               		.loc 1 373 96 discriminator 6 view .LVU40
 214 0060 8C0F      		add r24,r28
 215 0062 9D1F      		adc r25,r29
 216 0064 00C0      		rjmp .L28
 217               	.L27:
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 218               		.loc 1 373 13 view .LVU41
 219 0066 C901      		movw r24,r18
 220 0068 66E0      		ldi r22,lo8(6)
 221 006a 70E0      		ldi r23,0
 222 006c 0E94 0000 		call __mulhi3
 223 0070 DC01      		movw r26,r24
 224 0072 A050      		subi r26,lo8(-(waiting_buffer))
 225 0074 B040      		sbci r27,hi8(-(waiting_buffer))
 226 0076 1196      		adiw r26,1
 227 0078 8C91      		ld r24,X
 228 007a 1197      		sbiw r26,1
 229 007c 8113      		cpse r24,r17
 230 007e 00C0      		rjmp .L8
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 231               		.loc 1 373 13 discriminator 2 view .LVU42
 232 0080 8C91      		ld r24,X
 233 0082 8413      		cpse r24,r20
 234 0084 00C0      		rjmp .L8
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 235               		.loc 1 373 57 discriminator 3 view .LVU43
 236 0086 1296      		adiw r26,2
 237 0088 8C91      		ld r24,X
 238 008a 1297      		sbiw r26,2
 239 008c 8111      		cpse r24,__zero_reg__
 240 008e 00C0      		rjmp .L8
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 241               		.loc 1 373 96 discriminator 4 view .LVU44
 242 0090 1396      		adiw r26,3
 243 0092 8D91      		ld r24,X+
 244 0094 9C91      		ld r25,X
 245 0096 8E17      		cp r24,r30
 246 0098 9F07      		cpc r25,r31
 247 009a 00F0      		brlo .L10
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 248               		.loc 1 373 96 discriminator 5 view .LVU45
 249 009c 8E1B      		sub r24,r30
 250 009e 9F0B      		sbc r25,r31
 251               	.L28:
 373:tmk_core/common/action_tapping.c ****             tapping_key.tap.count       = 1;
 252               		.loc 1 373 96 discriminator 6 view .LVU46
 253 00a0 8A3A      		cpi r24,-86
 254 00a2 9105      		cpc r25,__zero_reg__
 255 00a4 00F4      		brsh .L8
 374:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 256               		.loc 1 374 13 is_stmt 1 view .LVU47
 374:tmk_core/common/action_tapping.c ****             waiting_buffer[i].tap.count = 1;
 257               		.loc 1 374 41 is_stmt 0 view .LVU48
 258 00a6 8091 0000 		lds r24,tapping_key+5
 259 00aa 8F70      		andi r24,lo8(15)
 260 00ac 8061      		ori r24,lo8(16)
 261 00ae 8093 0000 		sts tapping_key+5,r24
 375:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 262               		.loc 1 375 13 is_stmt 1 view .LVU49
 375:tmk_core/common/action_tapping.c ****             process_record(&tapping_key);
 263               		.loc 1 375 41 is_stmt 0 view .LVU50
 264 00b2 C901      		movw r24,r18
 265 00b4 66E0      		ldi r22,lo8(6)
 266 00b6 70E0      		ldi r23,0
 267 00b8 0E94 0000 		call __mulhi3
 268 00bc FC01      		movw r30,r24
 269 00be E050      		subi r30,lo8(-(waiting_buffer+5))
 270 00c0 F040      		sbci r31,hi8(-(waiting_buffer+5))
 271 00c2 9081      		ld r25,Z
 272 00c4 9F70      		andi r25,lo8(15)
 273 00c6 9061      		ori r25,lo8(16)
 274 00c8 9083      		st Z,r25
 376:tmk_core/common/action_tapping.c **** 
 275               		.loc 1 376 13 is_stmt 1 view .LVU51
 276 00ca 80E0      		ldi r24,lo8(tapping_key)
 277 00cc 90E0      		ldi r25,hi8(tapping_key)
 278 00ce 0E94 0000 		call process_record
 279               	.LVL12:
 378:tmk_core/common/action_tapping.c ****             debug_dec(i);
 280               		.loc 1 378 57 view .LVU52
 379:tmk_core/common/action_tapping.c ****             debug("]\n");
 281               		.loc 1 379 25 view .LVU53
 380:tmk_core/common/action_tapping.c ****             debug_waiting_buffer();
 282               		.loc 1 380 25 view .LVU54
 381:tmk_core/common/action_tapping.c ****             return;
 283               		.loc 1 381 13 view .LVU55
 284               	/* epilogue start */
 285               	.LBE11:
 385:tmk_core/common/action_tapping.c **** 
 286               		.loc 1 385 1 is_stmt 0 view .LVU56
 287 00d2 DF91      		pop r29
 288 00d4 CF91      		pop r28
 289 00d6 1F91      		pop r17
 290 00d8 0F91      		pop r16
 291 00da FF90      		pop r15
 292               	.LBB12:
 381:tmk_core/common/action_tapping.c ****             return;
 293               		.loc 1 381 13 view .LVU57
 294 00dc 0C94 0000 		jmp debug_waiting_buffer
 295               	.LVL13:
 296               	.LBE12:
 297               		.cfi_endproc
 298               	.LFE13:
 300               		.section	.text.process_tapping,"ax",@progbits
 302               	process_tapping:
 303               	.LVL14:
 304               	.LFB8:
  95:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 305               		.loc 1 95 41 is_stmt 1 view -0
 306               		.cfi_startproc
  95:tmk_core/common/action_tapping.c ****     keyevent_t event = keyp->event;
 307               		.loc 1 95 41 is_stmt 0 view .LVU59
 308 0000 BF92      		push r11
 309               	.LCFI7:
 310               		.cfi_def_cfa_offset 3
 311               		.cfi_offset 11, -2
 312 0002 CF92      		push r12
 313               	.LCFI8:
 314               		.cfi_def_cfa_offset 4
 315               		.cfi_offset 12, -3
 316 0004 DF92      		push r13
 317               	.LCFI9:
 318               		.cfi_def_cfa_offset 5
 319               		.cfi_offset 13, -4
 320 0006 EF92      		push r14
 321               	.LCFI10:
 322               		.cfi_def_cfa_offset 6
 323               		.cfi_offset 14, -5
 324 0008 FF92      		push r15
 325               	.LCFI11:
 326               		.cfi_def_cfa_offset 7
 327               		.cfi_offset 15, -6
 328 000a 0F93      		push r16
 329               	.LCFI12:
 330               		.cfi_def_cfa_offset 8
 331               		.cfi_offset 16, -7
 332 000c 1F93      		push r17
 333               	.LCFI13:
 334               		.cfi_def_cfa_offset 9
 335               		.cfi_offset 17, -8
 336 000e CF93      		push r28
 337               	.LCFI14:
 338               		.cfi_def_cfa_offset 10
 339               		.cfi_offset 28, -9
 340 0010 DF93      		push r29
 341               	.LCFI15:
 342               		.cfi_def_cfa_offset 11
 343               		.cfi_offset 29, -10
 344 0012 CDB7      		in r28,__SP_L__
 345 0014 DEB7      		in r29,__SP_H__
 346               	.LCFI16:
 347               		.cfi_def_cfa_register 28
 348 0016 6197      		sbiw r28,17
 349               	.LCFI17:
 350               		.cfi_def_cfa_offset 28
 351 0018 0FB6      		in __tmp_reg__,__SREG__
 352 001a F894      		cli
 353 001c DEBF      		out __SP_H__,r29
 354 001e 0FBE      		out __SREG__,__tmp_reg__
 355 0020 CDBF      		out __SP_L__,r28
 356               	/* prologue: function */
 357               	/* frame size = 17 */
 358               	/* stack size = 26 */
 359               	.L__stack_usage = 26
 360 0022 8C01      		movw r16,r24
  96:tmk_core/common/action_tapping.c **** 
 361               		.loc 1 96 5 is_stmt 1 view .LVU60
  96:tmk_core/common/action_tapping.c **** 
 362               		.loc 1 96 16 is_stmt 0 view .LVU61
 363 0024 85E0      		ldi r24,lo8(5)
 364               	.LVL15:
  96:tmk_core/common/action_tapping.c **** 
 365               		.loc 1 96 16 view .LVU62
 366 0026 F801      		movw r30,r16
 367 0028 DE01      		movw r26,r28
 368 002a 1D96      		adiw r26,13
 369               		0:
 370 002c 0190      		ld r0,Z+
 371 002e 0D92      		st X+,r0
 372 0030 8A95      		dec r24
 373 0032 01F4      		brne 0b
 374 0034 D801      		movw r26,r16
 375 0036 4C91      		ld r20,X
 376               	.LVL16:
  96:tmk_core/common/action_tapping.c **** 
 377               		.loc 1 96 16 view .LVU63
 378 0038 1196      		adiw r26,1
 379 003a 2C91      		ld r18,X
 380 003c 1197      		sbiw r26,1
 381               	.LVL17:
  96:tmk_core/common/action_tapping.c **** 
 382               		.loc 1 96 16 view .LVU64
 383 003e 1296      		adiw r26,2
 384 0040 EC90      		ld r14,X
 385 0042 1297      		sbiw r26,2
 386               	.LVL18:
  99:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 387               		.loc 1 99 5 is_stmt 1 view .LVU65
  99:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 388               		.loc 1 99 9 is_stmt 0 view .LVU66
 389 0044 8091 0000 		lds r24,tapping_key+3
 390 0048 9091 0000 		lds r25,tapping_key+3+1
 391               	.LBB23:
 392               	.LBI23:
 393               		.loc 2 48 20 is_stmt 1 view .LVU67
 394               	.LBB24:
 395               		.loc 2 48 51 view .LVU68
 396               		.loc 2 48 74 is_stmt 0 view .LVU69
 397 004c 0097      		sbiw r24,0
 398 004e 01F4      		brne .+2
 399 0050 00C0      		rjmp .L30
 400               	.LBE24:
 401               	.LBE23:
  99:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 402               		.loc 1 99 9 view .LVU70
 403 0052 3091 0000 		lds r19,tapping_key
 404 0056 5091 0000 		lds r21,tapping_key+1
 405               	.LBB26:
 406               	.LBB25:
 407               		.loc 2 48 74 view .LVU71
 408 005a 632F      		mov r22,r19
 409 005c 6523      		and r22,r21
 410 005e 6F3F      		cpi r22,lo8(-1)
 411 0060 01F4      		brne .+2
 412 0062 00C0      		rjmp .L30
 413               	.LBE25:
 414               	.LBE26:
  96:tmk_core/common/action_tapping.c **** 
 415               		.loc 1 96 16 discriminator 1 view .LVU72
 416 0064 1396      		adiw r26,3
 417 0066 CD90      		ld r12,X+
 418 0068 DC90      		ld r13,X
  99:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 419               		.loc 1 99 9 discriminator 1 view .LVU73
 420 006a B090 0000 		lds r11,tapping_key+2
 421 006e BB20      		tst r11
 422 0070 01F4      		brne .+2
 423 0072 00C0      		rjmp .L31
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 424               		.loc 1 100 9 is_stmt 1 view .LVU74
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 425               		.loc 1 100 13 is_stmt 0 view .LVU75
 426 0074 C816      		cp r12,r24
 427 0076 D906      		cpc r13,r25
 428 0078 00F0      		brlo .L32
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 429               		.loc 1 100 13 discriminator 1 view .LVU76
 430 007a F601      		movw r30,r12
 431 007c E81B      		sub r30,r24
 432 007e F90B      		sbc r31,r25
 433 0080 CF01      		movw r24,r30
 434               	.L123:
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 435               		.loc 1 100 13 discriminator 2 view .LVU77
 436 0082 FF24      		clr r15
 437 0084 F394      		inc r15
 438 0086 8A3A      		cpi r24,-86
 439 0088 9105      		cpc r25,__zero_reg__
 440 008a 00F0      		brlo .L34
 441 008c F12C      		mov r15,__zero_reg__
 442               	.L34:
 443 008e 8091 0000 		lds r24,tapping_key+5
 444 0092 982F      		mov r25,r24
 445 0094 907F      		andi r25,lo8(-16)
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 446               		.loc 1 100 12 discriminator 4 view .LVU78
 447 0096 FF20      		tst r15
 448 0098 01F4      		brne .+2
 449 009a 00C0      		rjmp .L36
 101:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 450               		.loc 1 101 13 is_stmt 1 view .LVU79
 101:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key) && !event.pressed) {
 451               		.loc 1 101 16 is_stmt 0 view .LVU80
 452 009c 9111      		cpse r25,__zero_reg__
 453 009e 00C0      		rjmp .L37
 102:tmk_core/common/action_tapping.c ****                     // first tap!
 454               		.loc 1 102 17 is_stmt 1 discriminator 1 view .LVU81
 455 00a0 FE2C      		mov r15,r14
 102:tmk_core/common/action_tapping.c ****                     // first tap!
 456               		.loc 1 102 21 is_stmt 0 discriminator 1 view .LVU82
 457 00a2 5213      		cpse r21,r18
 458 00a4 00C0      		rjmp .L38
 102:tmk_core/common/action_tapping.c ****                     // first tap!
 459               		.loc 1 102 21 discriminator 2 view .LVU83
 460 00a6 3413      		cpse r19,r20
 461 00a8 00C0      		rjmp .L38
 102:tmk_core/common/action_tapping.c ****                     // first tap!
 462               		.loc 1 102 47 discriminator 3 view .LVU84
 463 00aa E110      		cpse r14,__zero_reg__
 464 00ac 00C0      		rjmp .L38
 104:tmk_core/common/action_tapping.c ****                     tapping_key.tap.count = 1;
 465               		.loc 1 104 57 is_stmt 1 view .LVU85
 105:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 466               		.loc 1 105 21 view .LVU86
 105:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 467               		.loc 1 105 43 is_stmt 0 view .LVU87
 468 00ae 8F70      		andi r24,lo8(15)
 469 00b0 8061      		ori r24,lo8(16)
 470 00b2 8093 0000 		sts tapping_key+5,r24
 471               	.LVL19:
 106:tmk_core/common/action_tapping.c ****                     process_record(&tapping_key);
 472               		.loc 1 106 21 is_stmt 1 view .LVU88
 473 00b6 0E94 0000 		call debug_tapping_key
 474               	.LVL20:
 107:tmk_core/common/action_tapping.c **** 
 475               		.loc 1 107 21 view .LVU89
 476 00ba 80E0      		ldi r24,lo8(tapping_key)
 477 00bc 90E0      		ldi r25,hi8(tapping_key)
 478 00be 0E94 0000 		call process_record
 479               	.LVL21:
 110:tmk_core/common/action_tapping.c ****                     // enqueue
 480               		.loc 1 110 21 view .LVU90
 110:tmk_core/common/action_tapping.c ****                     // enqueue
 481               		.loc 1 110 31 is_stmt 0 view .LVU91
 482 00c2 8091 0000 		lds r24,tapping_key+5
 483 00c6 D801      		movw r26,r16
 484 00c8 1596      		adiw r26,5
 485 00ca 8C93      		st X,r24
 112:tmk_core/common/action_tapping.c ****                 }
 486               		.loc 1 112 21 is_stmt 1 view .LVU92
 487               	.LVL22:
 488               	.L29:
 305:tmk_core/common/action_tapping.c **** 
 489               		.loc 1 305 1 is_stmt 0 view .LVU93
 490 00cc 8F2D      		mov r24,r15
 491               	/* epilogue start */
 305:tmk_core/common/action_tapping.c **** 
 492               		.loc 1 305 1 view .LVU94
 493 00ce 6196      		adiw r28,17
 494 00d0 0FB6      		in __tmp_reg__,__SREG__
 495 00d2 F894      		cli
 496 00d4 DEBF      		out __SP_H__,r29
 497 00d6 0FBE      		out __SREG__,__tmp_reg__
 498 00d8 CDBF      		out __SP_L__,r28
 499 00da DF91      		pop r29
 500 00dc CF91      		pop r28
 501 00de 1F91      		pop r17
 502 00e0 0F91      		pop r16
 503               	.LVL23:
 305:tmk_core/common/action_tapping.c **** 
 504               		.loc 1 305 1 view .LVU95
 505 00e2 FF90      		pop r15
 506 00e4 EF90      		pop r14
 305:tmk_core/common/action_tapping.c **** 
 507               		.loc 1 305 1 view .LVU96
 508 00e6 DF90      		pop r13
 509 00e8 CF90      		pop r12
 510 00ea BF90      		pop r11
 511 00ec 0895      		ret
 512               	.LVL24:
 513               	.L32:
 100:tmk_core/common/action_tapping.c ****             if (tapping_key.tap.count == 0) {
 514               		.loc 1 100 13 discriminator 2 view .LVU97
 515 00ee 8095      		com r24
 516 00f0 9095      		com r25
 517 00f2 8C0D      		add r24,r12
 518 00f4 9D1D      		adc r25,r13
 519 00f6 00C0      		rjmp .L123
 520               	.L38:
 137:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 521               		.loc 1 137 22 is_stmt 1 view .LVU98
 522               	.LVL25:
 523               	.LBB27:
 524               	.LBI27:
  49:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
  50:tmk_core/common/keyboard.h **** static inline bool IS_RELEASED(keyevent_t event) { return (!IS_NOEVENT(event) && !event.pressed); }
 525               		.loc 2 50 20 view .LVU99
 526               	.LBB28:
 527               		.loc 2 50 52 view .LVU100
 528               	.LBB29:
 529               	.LBI29:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 530               		.loc 2 48 20 view .LVU101
 531               	.LBB30:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 532               		.loc 2 48 51 view .LVU102
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 533               		.loc 2 48 74 is_stmt 0 view .LVU103
 534 00f8 CD28      		or r12,r13
 535 00fa 01F0      		breq .L69
 536 00fc 822F      		mov r24,r18
 537 00fe 8423      		and r24,r20
 538 0100 8F3F      		cpi r24,lo8(-1)
 539 0102 01F0      		breq .+2
 540 0104 00C0      		rjmp .L41
 541               	.L69:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 542               		.loc 2 48 74 view .LVU104
 543               	.LBE30:
 544               	.LBE29:
 545               		.loc 2 50 79 view .LVU105
 546 0106 80E0      		ldi r24,0
 547               	.L40:
 548               	.LVL26:
 549               		.loc 2 50 79 view .LVU106
 550               	.LBE28:
 551               	.LBE27:
 137:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 552               		.loc 1 137 25 view .LVU107
 553 0108 B82F      		mov r27,r24
 554 010a B170      		andi r27,lo8(1)
 555 010c DB2E      		mov r13,r27
 556               	.LBB32:
 557               	.LBB33:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 558               		.loc 1 343 18 view .LVU108
 559 010e E091 0000 		lds r30,waiting_buffer_tail
 560               	.LVL27:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 561               		.loc 1 343 45 view .LVU109
 562 0112 3091 0000 		lds r19,waiting_buffer_head
 563               	.LBE33:
 564               	.LBE32:
 137:tmk_core/common/action_tapping.c ****                     // Modifier should be retained till end of this tapping.
 565               		.loc 1 137 25 view .LVU110
 566 0116 80FD      		sbrc r24,0
 567 0118 00C0      		rjmp .L43
 568               	.L42:
 158:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 569               		.loc 1 158 21 is_stmt 1 view .LVU111
 158:tmk_core/common/action_tapping.c ****                         tapping_key.tap.interrupted = true;
 570               		.loc 1 158 24 is_stmt 0 view .LVU112
 571 011a EE20      		tst r14
 572 011c 01F0      		breq .L29
 159:tmk_core/common/action_tapping.c ****                     }
 573               		.loc 1 159 25 is_stmt 1 view .LVU113
 159:tmk_core/common/action_tapping.c ****                     }
 574               		.loc 1 159 53 is_stmt 0 view .LVU114
 575 011e 8091 0000 		lds r24,tapping_key+5
 576 0122 8160      		ori r24,lo8(1<<0)
 577 0124 8093 0000 		sts tapping_key+5,r24
 162:tmk_core/common/action_tapping.c ****                 }
 578               		.loc 1 162 28 view .LVU115
 579 0128 F12C      		mov r15,__zero_reg__
 580 012a 00C0      		rjmp .L29
 581               	.L45:
 582               	.LBB35:
 583               	.LBB34:
 344:tmk_core/common/action_tapping.c ****             return true;
 584               		.loc 1 344 9 is_stmt 1 view .LVU116
 344:tmk_core/common/action_tapping.c ****             return true;
 585               		.loc 1 344 13 is_stmt 0 view .LVU117
 586 012c F0E0      		ldi r31,0
 587 012e CF01      		movw r24,r30
 588 0130 66E0      		ldi r22,lo8(6)
 589 0132 70E0      		ldi r23,0
 590 0134 0E94 0000 		call __mulhi3
 591 0138 DC01      		movw r26,r24
 592 013a A050      		subi r26,lo8(-(waiting_buffer))
 593 013c B040      		sbci r27,hi8(-(waiting_buffer))
 344:tmk_core/common/action_tapping.c ****             return true;
 594               		.loc 1 344 12 view .LVU118
 595 013e 1196      		adiw r26,1
 596 0140 8C91      		ld r24,X
 597 0142 1197      		sbiw r26,1
 598 0144 8213      		cpse r24,r18
 599 0146 00C0      		rjmp .L44
 344:tmk_core/common/action_tapping.c ****             return true;
 600               		.loc 1 344 13 view .LVU119
 601 0148 8C91      		ld r24,X
 602 014a 8413      		cpse r24,r20
 603 014c 00C0      		rjmp .L44
 344:tmk_core/common/action_tapping.c ****             return true;
 604               		.loc 1 344 59 view .LVU120
 605 014e 1296      		adiw r26,2
 606 0150 8C91      		ld r24,X
 607 0152 E812      		cpse r14,r24
 608 0154 00C0      		rjmp .L42
 609               	.L44:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 610               		.loc 1 343 76 view .LVU121
 611 0156 3196      		adiw r30,1
 612               	.LVL28:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 613               		.loc 1 343 71 view .LVU122
 614 0158 E770      		andi r30,lo8(7)
 615               	.L43:
 616               	.LVL29:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 617               		.loc 1 343 5 view .LVU123
 618 015a E313      		cpse r30,r19
 619 015c 00C0      		rjmp .L45
 620               	.LVL30:
 343:tmk_core/common/action_tapping.c ****         if (KEYEQ(event.key, waiting_buffer[i].event.key) && event.pressed != waiting_buffer[i].eve
 621               		.loc 1 343 5 view .LVU124
 622               	.LBE34:
 623               	.LBE35:
 624               	.LBB36:
 139:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 625               		.loc 1 139 21 is_stmt 1 view .LVU125
 139:tmk_core/common/action_tapping.c ****                     switch (action.kind.id) {
 626               		.loc 1 139 39 is_stmt 0 view .LVU126
 627 015e 4D87      		std Y+13,r20
 628 0160 2E87      		std Y+14,r18
 629 0162 8D85      		ldd r24,Y+13
 630 0164 9E85      		ldd r25,Y+14
 631 0166 0E94 0000 		call layer_switch_get_action
 632               	.LVL31:
 140:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 633               		.loc 1 140 21 is_stmt 1 view .LVU127
 140:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 634               		.loc 1 140 40 is_stmt 0 view .LVU128
 635 016a 292F      		mov r18,r25
 636 016c 2295      		swap r18
 637 016e 2F70      		andi r18,lo8(15)
 140:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 638               		.loc 1 140 21 view .LVU129
 639 0170 2230      		cpi r18,lo8(2)
 640 0172 00F0      		brlo .L67
 140:tmk_core/common/action_tapping.c ****                         case ACT_LMODS:
 641               		.loc 1 140 21 view .LVU130
 642 0174 2430      		cpi r18,lo8(4)
 643 0176 00F4      		brsh .L49
 148:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 644               		.loc 1 148 29 is_stmt 1 view .LVU131
 148:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 645               		.loc 1 148 33 is_stmt 0 view .LVU132
 646 0178 9F70      		andi r25,lo8(15)
 647               	.LVL32:
 148:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 648               		.loc 1 148 32 view .LVU133
 649 017a 01F0      		breq .L50
 148:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 650               		.loc 1 148 68 discriminator 1 view .LVU134
 651 017c F801      		movw r30,r16
 652 017e 9581      		ldd r25,Z+5
 653 0180 907F      		andi r25,lo8(-16)
 148:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 654               		.loc 1 148 49 discriminator 1 view .LVU135
 655 0182 01F4      		brne .L50
 656               	.LVL33:
 657               	.L73:
 143:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 658               		.loc 1 143 77 view .LVU136
 659 0184 D12C      		mov r13,__zero_reg__
 660 0186 00C0      		rjmp .L48
 661               	.LVL34:
 662               	.L67:
 143:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 663               		.loc 1 143 29 is_stmt 1 view .LVU137
 143:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 664               		.loc 1 143 33 is_stmt 0 view .LVU138
 665 0188 9F70      		andi r25,lo8(15)
 666               	.LVL35:
 143:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 667               		.loc 1 143 32 view .LVU139
 668 018a 01F0      		breq .L50
 143:tmk_core/common/action_tapping.c ****                             if (IS_MOD(action.key.code)) return false;
 669               		.loc 1 143 49 discriminator 1 view .LVU140
 670 018c 8823      		tst r24
 671 018e 01F0      		breq .L73
 672               	.L50:
 149:tmk_core/common/action_tapping.c ****                             break;
 673               		.loc 1 149 29 is_stmt 1 view .LVU141
 149:tmk_core/common/action_tapping.c ****                             break;
 674               		.loc 1 149 33 is_stmt 0 view .LVU142
 675 0190 805E      		subi r24,lo8(-(32))
 676               	.LVL36:
 149:tmk_core/common/action_tapping.c ****                             break;
 677               		.loc 1 149 32 view .LVU143
 678 0192 8830      		cpi r24,lo8(8)
 679 0194 00F0      		brlo .L73
 680               	.LVL37:
 681               	.L49:
 153:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 682               		.loc 1 153 86 is_stmt 1 view .LVU144
 154:tmk_core/common/action_tapping.c ****                     return true;
 683               		.loc 1 154 21 view .LVU145
 684 0196 C801      		movw r24,r16
 685               	.LVL38:
 154:tmk_core/common/action_tapping.c ****                     return true;
 686               		.loc 1 154 21 is_stmt 0 view .LVU146
 687 0198 0E94 0000 		call process_record
 688               	.LVL39:
 155:tmk_core/common/action_tapping.c ****                 } else {
 689               		.loc 1 155 21 is_stmt 1 view .LVU147
 690               	.L48:
 155:tmk_core/common/action_tapping.c ****                 } else {
 691               		.loc 1 155 21 is_stmt 0 view .LVU148
 692 019c FD2C      		mov r15,r13
 693 019e 00C0      		rjmp .L29
 694               	.LVL40:
 695               	.L37:
 155:tmk_core/common/action_tapping.c ****                 } else {
 696               		.loc 1 155 21 view .LVU149
 697               	.LBE36:
 167:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 698               		.loc 1 167 17 is_stmt 1 discriminator 1 view .LVU150
 167:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 699               		.loc 1 167 21 is_stmt 0 discriminator 1 view .LVU151
 700 01a0 5213      		cpse r21,r18
 701 01a2 00C0      		rjmp .L51
 167:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 702               		.loc 1 167 21 discriminator 2 view .LVU152
 703 01a4 3413      		cpse r19,r20
 704 01a6 00C0      		rjmp .L51
 171:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 705               		.loc 1 171 31 discriminator 3 view .LVU153
 706 01a8 D801      		movw r26,r16
 167:tmk_core/common/action_tapping.c ****                     debug("Tapping: Tap release(");
 707               		.loc 1 167 47 discriminator 3 view .LVU154
 708 01aa EE20      		tst r14
 709 01ac 01F4      		brne .+2
 710 01ae 00C0      		rjmp .L130
 711               	.L51:
 176:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 712               		.loc 1 176 24 is_stmt 1 view .LVU155
 176:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 713               		.loc 1 176 28 is_stmt 0 view .LVU156
 714 01b0 4D87      		std Y+13,r20
 715 01b2 2E87      		std Y+14,r18
 716 01b4 8D85      		ldd r24,Y+13
 717 01b6 9E85      		ldd r25,Y+14
 718 01b8 0E94 0000 		call is_tap_key
 719               	.LVL41:
 176:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 720               		.loc 1 176 27 view .LVU157
 721 01bc 8823      		tst r24
 722 01be 01F0      		breq .L63
 176:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 723               		.loc 1 176 50 discriminator 1 view .LVU158
 724 01c0 EE20      		tst r14
 725 01c2 01F0      		breq .L63
 177:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 726               		.loc 1 177 21 is_stmt 1 view .LVU159
 177:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 727               		.loc 1 177 40 is_stmt 0 view .LVU160
 728 01c4 8091 0000 		lds r24,tapping_key+5
 177:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last tap(>1).\n");
 729               		.loc 1 177 24 view .LVU161
 730 01c8 8032      		cpi r24,lo8(32)
 731 01ca 00F0      		brlo .L54
 178:tmk_core/common/action_tapping.c ****                         // unregister key
 732               		.loc 1 178 87 is_stmt 1 view .LVU162
 180:tmk_core/common/action_tapping.c ****                     } else {
 733               		.loc 1 180 25 view .LVU163
 180:tmk_core/common/action_tapping.c ****                     } else {
 734               		.loc 1 180 54 is_stmt 0 view .LVU164
 735 01cc 2091 0000 		lds r18,tapping_key
 736 01d0 3091 0000 		lds r19,tapping_key+1
 737 01d4 3887      		std Y+8,r19
 738 01d6 2F83      		std Y+7,r18
 739 01d8 1986      		std Y+9,__zero_reg__
 740 01da DB86      		std Y+11,r13
 741 01dc CA86      		std Y+10,r12
 742 01de 8C87      		std Y+12,r24
 180:tmk_core/common/action_tapping.c ****                     } else {
 743               		.loc 1 180 25 view .LVU165
 744 01e0 CE01      		movw r24,r28
 745 01e2 0796      		adiw r24,7
 746               	.L124:
 180:tmk_core/common/action_tapping.c ****                     } else {
 747               		.loc 1 180 25 view .LVU166
 748 01e4 0E94 0000 		call process_record
 749               	.LVL42:
 750               	.L54:
 182:tmk_core/common/action_tapping.c ****                     }
 751               		.loc 1 182 69 is_stmt 1 view .LVU167
 184:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 752               		.loc 1 184 21 view .LVU168
 184:tmk_core/common/action_tapping.c ****                     waiting_buffer_scan_tap();
 753               		.loc 1 184 33 is_stmt 0 view .LVU169
 754 01e8 86E0      		ldi r24,lo8(6)
 755 01ea F801      		movw r30,r16
 756 01ec A0E0      		ldi r26,lo8(tapping_key)
 757 01ee B0E0      		ldi r27,hi8(tapping_key)
 758               		0:
 759 01f0 0190      		ld r0,Z+
 760 01f2 0D92      		st X+,r0
 761 01f4 8A95      		dec r24
 762 01f6 01F4      		brne 0b
 185:tmk_core/common/action_tapping.c ****                     debug_tapping_key();
 763               		.loc 1 185 21 is_stmt 1 view .LVU170
 764 01f8 0E94 0000 		call waiting_buffer_scan_tap
 765               	.LVL43:
 186:tmk_core/common/action_tapping.c ****                     return true;
 766               		.loc 1 186 21 view .LVU171
 767 01fc 0E94 0000 		call debug_tapping_key
 768               	.LVL44:
 187:tmk_core/common/action_tapping.c ****                 } else {
 769               		.loc 1 187 21 view .LVU172
 770               	.L127:
 193:tmk_core/common/action_tapping.c ****                 }
 771               		.loc 1 193 21 view .LVU173
 193:tmk_core/common/action_tapping.c ****                 }
 772               		.loc 1 193 28 is_stmt 0 view .LVU174
 773 0200 FF24      		clr r15
 774 0202 F394      		inc r15
 775 0204 00C0      		rjmp .L29
 776               	.L63:
 189:tmk_core/common/action_tapping.c ****                         debug("Tapping: key event while last tap(>0).\n");
 777               		.loc 1 189 21 is_stmt 1 view .LVU175
 190:tmk_core/common/action_tapping.c ****                     }
 778               		.loc 1 190 74 view .LVU176
 192:tmk_core/common/action_tapping.c ****                     return true;
 779               		.loc 1 192 21 view .LVU177
 780 0206 C801      		movw r24,r16
 781 0208 0E94 0000 		call process_record
 782               	.LVL45:
 783 020c 00C0      		rjmp .L127
 784               	.LVL46:
 785               	.L36:
 199:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 786               		.loc 1 199 13 view .LVU178
 199:tmk_core/common/action_tapping.c ****                 debug("Tapping: End. Timeout. Not tap(0): ");
 787               		.loc 1 199 16 is_stmt 0 view .LVU179
 788 020e 9111      		cpse r25,__zero_reg__
 789 0210 00C0      		rjmp .L55
 200:tmk_core/common/action_tapping.c ****                 debug_event(event);
 790               		.loc 1 200 61 is_stmt 1 view .LVU180
 201:tmk_core/common/action_tapping.c ****                 debug("\n");
 791               		.loc 1 201 17 view .LVU181
 201:tmk_core/common/action_tapping.c ****                 debug("\n");
 792               		.loc 1 201 17 is_stmt 0 view .LVU182
 793 0212 7C2D      		mov r23,r12
 794 0214 D98A      		std Y+17,r13
 795 0216 C88A      		std Y+16,r12
 796 0218 522F      		mov r21,r18
 797 021a 6E2D      		mov r22,r14
 798 021c 8989      		ldd r24,Y+17
 799 021e 0E94 0000 		call debug_event
 800               	.LVL47:
 202:tmk_core/common/action_tapping.c ****                 process_record(&tapping_key);
 801               		.loc 1 202 28 is_stmt 1 view .LVU183
 203:tmk_core/common/action_tapping.c ****                 tapping_key = (keyrecord_t){};
 802               		.loc 1 203 17 view .LVU184
 803 0222 80E0      		ldi r24,lo8(tapping_key)
 804 0224 90E0      		ldi r25,hi8(tapping_key)
 805 0226 0E94 0000 		call process_record
 806               	.LVL48:
 204:tmk_core/common/action_tapping.c ****                 debug_tapping_key();
 807               		.loc 1 204 17 view .LVU185
 808               	.L131:
 285:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 809               		.loc 1 285 24 view .LVU186
 286:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 810               		.loc 1 286 13 view .LVU187
 286:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 811               		.loc 1 286 25 is_stmt 0 view .LVU188
 812 022a 86E0      		ldi r24,lo8(6)
 813 022c E0E0      		ldi r30,lo8(tapping_key)
 814 022e F0E0      		ldi r31,hi8(tapping_key)
 815 0230 DF01      		movw r26,r30
 816               		0:
 817 0232 1D92      		st X+,__zero_reg__
 818 0234 8A95      		dec r24
 819 0236 01F4      		brne 0b
 287:tmk_core/common/action_tapping.c ****             return false;
 820               		.loc 1 287 13 is_stmt 1 view .LVU189
 821 0238 00C0      		rjmp .L126
 822               	.LVL49:
 823               	.L55:
 208:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 824               		.loc 1 208 17 discriminator 1 view .LVU190
 208:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 825               		.loc 1 208 21 is_stmt 0 discriminator 1 view .LVU191
 826 023a 5213      		cpse r21,r18
 827 023c 00C0      		rjmp .L56
 208:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 828               		.loc 1 208 21 discriminator 2 view .LVU192
 829 023e 3413      		cpse r19,r20
 830 0240 00C0      		rjmp .L56
 208:tmk_core/common/action_tapping.c ****                     debug("Tapping: End. last timeout tap release(>0).");
 831               		.loc 1 208 47 discriminator 3 view .LVU193
 832 0242 E110      		cpse r14,__zero_reg__
 833 0244 00C0      		rjmp .L56
 209:tmk_core/common/action_tapping.c ****                     keyp->tap = tapping_key.tap;
 834               		.loc 1 209 73 is_stmt 1 view .LVU194
 210:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 835               		.loc 1 210 21 view .LVU195
 210:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 836               		.loc 1 210 31 is_stmt 0 view .LVU196
 837 0246 F801      		movw r30,r16
 838 0248 8583      		std Z+5,r24
 211:tmk_core/common/action_tapping.c ****                     tapping_key = (keyrecord_t){};
 839               		.loc 1 211 21 is_stmt 1 view .LVU197
 840 024a C801      		movw r24,r16
 841 024c 0E94 0000 		call process_record
 842               	.LVL50:
 212:tmk_core/common/action_tapping.c ****                     return true;
 843               		.loc 1 212 21 view .LVU198
 212:tmk_core/common/action_tapping.c ****                     return true;
 844               		.loc 1 212 33 is_stmt 0 view .LVU199
 845 0250 E0E0      		ldi r30,lo8(tapping_key)
 846 0252 F0E0      		ldi r31,hi8(tapping_key)
 847 0254 86E0      		ldi r24,lo8(6)
 848 0256 DF01      		movw r26,r30
 849               		0:
 850 0258 1D92      		st X+,__zero_reg__
 851 025a 8A95      		dec r24
 852 025c 01F4      		brne 0b
 213:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 853               		.loc 1 213 21 is_stmt 1 view .LVU200
 213:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key) && event.pressed) {
 854               		.loc 1 213 28 is_stmt 0 view .LVU201
 855 025e FB2C      		mov r15,r11
 856 0260 00C0      		rjmp .L29
 857               	.LVL51:
 858               	.L56:
 214:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 859               		.loc 1 214 24 is_stmt 1 view .LVU202
 214:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 860               		.loc 1 214 28 is_stmt 0 view .LVU203
 861 0262 4D87      		std Y+13,r20
 862 0264 2E87      		std Y+14,r18
 863 0266 8D85      		ldd r24,Y+13
 864 0268 9E85      		ldd r25,Y+14
 865 026a 0E94 0000 		call is_tap_key
 866               	.LVL52:
 214:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 867               		.loc 1 214 27 view .LVU204
 868 026e 8823      		tst r24
 869 0270 01F0      		breq .L63
 214:tmk_core/common/action_tapping.c ****                     if (tapping_key.tap.count > 1) {
 870               		.loc 1 214 50 discriminator 1 view .LVU205
 871 0272 EE20      		tst r14
 872 0274 01F0      		breq .L63
 215:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 873               		.loc 1 215 21 is_stmt 1 view .LVU206
 215:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 874               		.loc 1 215 40 is_stmt 0 view .LVU207
 875 0276 8091 0000 		lds r24,tapping_key+5
 215:tmk_core/common/action_tapping.c ****                         debug("Tapping: Start new tap with releasing last timeout tap(>1).\n");
 876               		.loc 1 215 24 view .LVU208
 877 027a 8032      		cpi r24,lo8(32)
 878 027c 00F4      		brsh .+2
 879 027e 00C0      		rjmp .L54
 216:tmk_core/common/action_tapping.c ****                         // unregister key
 880               		.loc 1 216 95 is_stmt 1 view .LVU209
 218:tmk_core/common/action_tapping.c ****                     } else {
 881               		.loc 1 218 25 view .LVU210
 218:tmk_core/common/action_tapping.c ****                     } else {
 882               		.loc 1 218 54 is_stmt 0 view .LVU211
 883 0280 2091 0000 		lds r18,tapping_key
 884 0284 3091 0000 		lds r19,tapping_key+1
 885 0288 3A83      		std Y+2,r19
 886 028a 2983      		std Y+1,r18
 887 028c 1B82      		std Y+3,__zero_reg__
 888 028e DD82      		std Y+5,r13
 889 0290 CC82      		std Y+4,r12
 890 0292 8E83      		std Y+6,r24
 218:tmk_core/common/action_tapping.c ****                     } else {
 891               		.loc 1 218 25 view .LVU212
 892 0294 CE01      		movw r24,r28
 893 0296 0196      		adiw r24,1
 894 0298 00C0      		rjmp .L124
 895               	.LVL53:
 896               	.L31:
 235:tmk_core/common/action_tapping.c ****         if (WITHIN_TAPPING_TERM(event)) {
 897               		.loc 1 235 12 is_stmt 1 discriminator 1 view .LVU213
 236:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 898               		.loc 1 236 9 discriminator 1 view .LVU214
 236:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 899               		.loc 1 236 13 is_stmt 0 discriminator 1 view .LVU215
 900 029a C816      		cp r12,r24
 901 029c D906      		cpc r13,r25
 902 029e 00F0      		brlo .L58
 903 02a0 F601      		movw r30,r12
 904 02a2 E81B      		sub r30,r24
 905 02a4 F90B      		sbc r31,r25
 906 02a6 CF01      		movw r24,r30
 907               	.L129:
 236:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 908               		.loc 1 236 13 discriminator 2 view .LVU216
 909 02a8 F12C      		mov r15,__zero_reg__
 910 02aa 8A3A      		cpi r24,-86
 911 02ac 9105      		cpc r25,__zero_reg__
 912 02ae 00F0      		brlo .+2
 913 02b0 00C0      		rjmp .L62
 237:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 914               		.loc 1 237 13 is_stmt 1 view .LVU217
 237:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 915               		.loc 1 237 22 is_stmt 0 view .LVU218
 916 02b2 FE2C      		mov r15,r14
 237:tmk_core/common/action_tapping.c ****                 if (IS_TAPPING_KEY(event.key)) {
 917               		.loc 1 237 16 view .LVU219
 918 02b4 EE20      		tst r14
 919 02b6 01F4      		brne .+2
 920 02b8 00C0      		rjmp .L63
 238:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 921               		.loc 1 238 17 is_stmt 1 discriminator 1 view .LVU220
 238:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 922               		.loc 1 238 21 is_stmt 0 discriminator 1 view .LVU221
 923 02ba 5213      		cpse r21,r18
 924 02bc 00C0      		rjmp .L64
 238:tmk_core/common/action_tapping.c **** //#    ifndef TAPPING_FORCE_HOLD
 925               		.loc 1 238 21 discriminator 2 view .LVU222
 926 02be 3413      		cpse r19,r20
 927 02c0 00C0      		rjmp .L64
 241:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 928               		.loc 1 241 21 is_stmt 1 view .LVU223
 245:tmk_core/common/action_tapping.c ****                         // sequential tap.
 929               		.loc 1 245 41 is_stmt 0 view .LVU224
 930 02c2 8091 0000 		lds r24,tapping_key+5
 241:tmk_core/common/action_tapping.c **** #        ifdef TAPPING_FORCE_HOLD_PER_KEY
 931               		.loc 1 241 24 view .LVU225
 932 02c6 80FD      		sbrc r24,0
 933 02c8 00C0      		rjmp .L65
 245:tmk_core/common/action_tapping.c ****                         // sequential tap.
 934               		.loc 1 245 79 view .LVU226
 935 02ca 982F      		mov r25,r24
 936 02cc 907F      		andi r25,lo8(-16)
 245:tmk_core/common/action_tapping.c ****                         // sequential tap.
 937               		.loc 1 245 54 view .LVU227
 938 02ce 01F0      		breq .L65
 247:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 939               		.loc 1 247 25 is_stmt 1 view .LVU228
 247:tmk_core/common/action_tapping.c ****                         if (keyp->tap.count < 15) keyp->tap.count += 1;
 940               		.loc 1 247 35 is_stmt 0 view .LVU229
 941 02d0 D801      		movw r26,r16
 942 02d2 1596      		adiw r26,5
 943 02d4 8C93      		st X,r24
 944 02d6 1597      		sbiw r26,5
 248:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 945               		.loc 1 248 25 is_stmt 1 view .LVU230
 248:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 946               		.loc 1 248 28 is_stmt 0 view .LVU231
 947 02d8 903F      		cpi r25,lo8(-16)
 948 02da 01F0      		breq .L66
 248:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 949               		.loc 1 248 51 is_stmt 1 discriminator 1 view .LVU232
 248:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 950               		.loc 1 248 67 is_stmt 0 discriminator 1 view .LVU233
 951 02dc 982F      		mov r25,r24
 952 02de 907F      		andi r25,lo8(-16)
 953 02e0 905F      		subi r25,lo8(-(16))
 954 02e2 8F70      		andi r24,lo8(15)
 955 02e4 892B      		or r24,r25
 956               	.L130:
 248:tmk_core/common/action_tapping.c ****                         debug("Tapping: Tap press(");
 957               		.loc 1 248 67 discriminator 1 view .LVU234
 958 02e6 1596      		adiw r26,5
 959 02e8 8C93      		st X,r24
 960               	.L66:
 249:tmk_core/common/action_tapping.c ****                         debug_dec(keyp->tap.count);
 961               		.loc 1 249 53 is_stmt 1 view .LVU235
 250:tmk_core/common/action_tapping.c ****                         debug(")\n");
 962               		.loc 1 250 51 view .LVU236
 251:tmk_core/common/action_tapping.c ****                         process_record(keyp);
 963               		.loc 1 251 37 view .LVU237
 252:tmk_core/common/action_tapping.c ****                         tapping_key = *keyp;
 964               		.loc 1 252 25 view .LVU238
 965 02ea C801      		movw r24,r16
 966 02ec 0E94 0000 		call process_record
 967               	.LVL54:
 253:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 968               		.loc 1 253 25 view .LVU239
 253:tmk_core/common/action_tapping.c ****                         debug_tapping_key();
 969               		.loc 1 253 37 is_stmt 0 view .LVU240
 970 02f0 86E0      		ldi r24,lo8(6)
 971 02f2 F801      		movw r30,r16
 972 02f4 A0E0      		ldi r26,lo8(tapping_key)
 973 02f6 B0E0      		ldi r27,hi8(tapping_key)
 974               		0:
 975 02f8 0190      		ld r0,Z+
 976 02fa 0D92      		st X+,r0
 977 02fc 8A95      		dec r24
 978 02fe 01F4      		brne 0b
 254:tmk_core/common/action_tapping.c ****                         return true;
 979               		.loc 1 254 25 is_stmt 1 view .LVU241
 980               	.LVL55:
 981               	.L126:
 298:tmk_core/common/action_tapping.c ****             return true;
 982               		.loc 1 298 13 view .LVU242
 983 0300 0E94 0000 		call debug_tapping_key
 984               	.LVL56:
 299:tmk_core/common/action_tapping.c ****         } else {
 985               		.loc 1 299 13 view .LVU243
 299:tmk_core/common/action_tapping.c ****         } else {
 986               		.loc 1 299 20 is_stmt 0 view .LVU244
 987 0304 00C0      		rjmp .L29
 988               	.LVL57:
 989               	.L58:
 236:tmk_core/common/action_tapping.c ****             if (event.pressed) {
 990               		.loc 1 236 13 discriminator 2 view .LVU245
 991 0306 8095      		com r24
 992 0308 9095      		com r25
 993 030a 8C0D      		add r24,r12
 994 030c 9D1D      		adc r25,r13
 995 030e 00C0      		rjmp .L129
 996               	.L65:
 259:tmk_core/common/action_tapping.c ****                     return true;
 997               		.loc 1 259 21 is_stmt 1 view .LVU246
 259:tmk_core/common/action_tapping.c ****                     return true;
 998               		.loc 1 259 33 is_stmt 0 view .LVU247
 999 0310 86E0      		ldi r24,lo8(6)
 1000 0312 F801      		movw r30,r16
 1001 0314 A0E0      		ldi r26,lo8(tapping_key)
 1002 0316 B0E0      		ldi r27,hi8(tapping_key)
 1003               		0:
 1004 0318 0190      		ld r0,Z+
 1005 031a 0D92      		st X+,r0
 1006 031c 8A95      		dec r24
 1007 031e 01F4      		brne 0b
 260:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1008               		.loc 1 260 21 is_stmt 1 view .LVU248
 260:tmk_core/common/action_tapping.c ****                 } else if (is_tap_key(event.key)) {
 1009               		.loc 1 260 28 is_stmt 0 view .LVU249
 1010 0320 00C0      		rjmp .L29
 1011               	.L64:
 261:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1012               		.loc 1 261 24 is_stmt 1 view .LVU250
 261:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1013               		.loc 1 261 28 is_stmt 0 view .LVU251
 1014 0322 4D87      		std Y+13,r20
 1015 0324 2E87      		std Y+14,r18
 1016 0326 8D85      		ldd r24,Y+13
 1017 0328 9E85      		ldd r25,Y+14
 1018 032a 0E94 0000 		call is_tap_key
 1019               	.LVL58:
 261:tmk_core/common/action_tapping.c ****                     // Sequential tap can be interfered with other tap key.
 1020               		.loc 1 261 27 view .LVU252
 1021 032e 8111      		cpse r24,__zero_reg__
 1022 0330 00C0      		rjmp .L54
 271:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1023               		.loc 1 271 21 is_stmt 1 view .LVU253
 271:tmk_core/common/action_tapping.c ****                     process_record(keyp);
 1024               		.loc 1 271 49 is_stmt 0 view .LVU254
 1025 0332 8091 0000 		lds r24,tapping_key+5
 1026 0336 8160      		ori r24,lo8(1<<0)
 1027 0338 8093 0000 		sts tapping_key+5,r24
 272:tmk_core/common/action_tapping.c ****                     return true;
 1028               		.loc 1 272 21 is_stmt 1 view .LVU255
 1029 033c C801      		movw r24,r16
 1030 033e 0E94 0000 		call process_record
 1031               	.LVL59:
 273:tmk_core/common/action_tapping.c ****                 }
 1032               		.loc 1 273 21 view .LVU256
 273:tmk_core/common/action_tapping.c ****                 }
 1033               		.loc 1 273 28 is_stmt 0 view .LVU257
 1034 0342 00C0      		rjmp .L29
 1035               	.LVL60:
 1036               	.L62:
 283:tmk_core/common/action_tapping.c ****             debug_event(event);
 1037               		.loc 1 283 70 is_stmt 1 view .LVU258
 284:tmk_core/common/action_tapping.c ****             debug("\n");
 1038               		.loc 1 284 13 view .LVU259
 284:tmk_core/common/action_tapping.c ****             debug("\n");
 1039               		.loc 1 284 13 is_stmt 0 view .LVU260
 1040 0344 7C2D      		mov r23,r12
 1041 0346 D98A      		std Y+17,r13
 1042 0348 C88A      		std Y+16,r12
 1043 034a 522F      		mov r21,r18
 1044 034c 6E2D      		mov r22,r14
 1045 034e 8989      		ldd r24,Y+17
 1046 0350 0E94 0000 		call debug_event
 1047               	.LVL61:
 284:tmk_core/common/action_tapping.c ****             debug("\n");
 1048               		.loc 1 284 13 view .LVU261
 1049 0354 00C0      		rjmp .L131
 1050               	.LVL62:
 1051               	.L30:
 293:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1052               		.loc 1 293 9 is_stmt 1 view .LVU262
 293:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1053               		.loc 1 293 12 is_stmt 0 view .LVU263
 1054 0356 EE20      		tst r14
 1055 0358 01F4      		brne .+2
 1056 035a 00C0      		rjmp .L63
 293:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1057               		.loc 1 293 30 discriminator 1 view .LVU264
 1058 035c 4D87      		std Y+13,r20
 1059 035e 2E87      		std Y+14,r18
 1060 0360 8D85      		ldd r24,Y+13
 1061 0362 9E85      		ldd r25,Y+14
 1062 0364 0E94 0000 		call is_tap_key
 1063               	.LVL63:
 293:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1064               		.loc 1 293 30 discriminator 1 view .LVU265
 1065 0368 F82E      		mov r15,r24
 293:tmk_core/common/action_tapping.c ****             debug("Tapping: Start(Press tap key).\n");
 1066               		.loc 1 293 27 discriminator 1 view .LVU266
 1067 036a 8823      		tst r24
 1068 036c 01F4      		brne .+2
 1069 036e 00C0      		rjmp .L63
 294:tmk_core/common/action_tapping.c ****             tapping_key = *keyp;
 1070               		.loc 1 294 54 is_stmt 1 view .LVU267
 295:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1071               		.loc 1 295 13 view .LVU268
 295:tmk_core/common/action_tapping.c ****             process_record_tap_hint(&tapping_key);
 1072               		.loc 1 295 25 is_stmt 0 view .LVU269
 1073 0370 86E0      		ldi r24,lo8(6)
 1074 0372 F801      		movw r30,r16
 1075 0374 A0E0      		ldi r26,lo8(tapping_key)
 1076 0376 B0E0      		ldi r27,hi8(tapping_key)
 1077               		0:
 1078 0378 0190      		ld r0,Z+
 1079 037a 0D92      		st X+,r0
 1080 037c 8A95      		dec r24
 1081 037e 01F4      		brne 0b
 296:tmk_core/common/action_tapping.c ****             waiting_buffer_scan_tap();
 1082               		.loc 1 296 13 is_stmt 1 view .LVU270
 1083 0380 80E0      		ldi r24,lo8(tapping_key)
 1084 0382 90E0      		ldi r25,hi8(tapping_key)
 1085 0384 0E94 0000 		call process_record_tap_hint
 1086               	.LVL64:
 297:tmk_core/common/action_tapping.c ****             debug_tapping_key();
 1087               		.loc 1 297 13 view .LVU271
 1088 0388 0E94 0000 		call waiting_buffer_scan_tap
 1089               	.LVL65:
 1090 038c 00C0      		rjmp .L126
 1091               	.LVL66:
 1092               	.L41:
 1093               	.LBB37:
 1094               	.LBB31:
 1095               		.loc 2 50 79 is_stmt 0 view .LVU272
 1096 038e 81E0      		ldi r24,lo8(1)
 1097 0390 8E25      		eor r24,r14
 1098 0392 00C0      		rjmp .L40
 1099               	.LBE31:
 1100               	.LBE37:
 1101               		.cfi_endproc
 1102               	.LFE8:
 1104               		.section	.text.get_tapping_term,"ax",@progbits
 1105               		.weak	get_tapping_term
 1107               	get_tapping_term:
 1108               	.LVL67:
 1109               	.LFB6:
  22:tmk_core/common/action_tapping.c **** 
 1110               		.loc 1 22 67 is_stmt 1 view -0
 1111               		.cfi_startproc
 1112               	/* prologue: function */
 1113               	/* frame size = 0 */
 1114               	/* stack size = 0 */
 1115               	.L__stack_usage = 0
  22:tmk_core/common/action_tapping.c **** 
 1116               		.loc 1 22 69 view .LVU274
  22:tmk_core/common/action_tapping.c **** 
 1117               		.loc 1 22 1 is_stmt 0 view .LVU275
 1118 0000 8AEA      		ldi r24,lo8(-86)
 1119 0002 90E0      		ldi r25,0
 1120               	.LVL68:
 1121               	/* epilogue start */
  22:tmk_core/common/action_tapping.c **** 
 1122               		.loc 1 22 1 view .LVU276
 1123 0004 0895      		ret
 1124               		.cfi_endproc
 1125               	.LFE6:
 1127               		.section	.text.action_tapping_process,"ax",@progbits
 1128               	.global	action_tapping_process
 1130               	action_tapping_process:
 1131               	.LFB7:
  52:tmk_core/common/action_tapping.c ****     if (process_tapping(&record)) {
 1132               		.loc 1 52 49 is_stmt 1 view -0
 1133               		.cfi_startproc
 1134 0000 CF93      		push r28
 1135               	.LCFI18:
 1136               		.cfi_def_cfa_offset 3
 1137               		.cfi_offset 28, -2
 1138 0002 DF93      		push r29
 1139               	.LCFI19:
 1140               		.cfi_def_cfa_offset 4
 1141               		.cfi_offset 29, -3
 1142 0004 CDB7      		in r28,__SP_L__
 1143 0006 DEB7      		in r29,__SP_H__
 1144               	.LCFI20:
 1145               		.cfi_def_cfa_register 28
 1146 0008 2C97      		sbiw r28,12
 1147               	.LCFI21:
 1148               		.cfi_def_cfa_offset 16
 1149 000a 0FB6      		in __tmp_reg__,__SREG__
 1150 000c F894      		cli
 1151 000e DEBF      		out __SP_H__,r29
 1152 0010 0FBE      		out __SREG__,__tmp_reg__
 1153 0012 CDBF      		out __SP_L__,r28
 1154               	/* prologue: function */
 1155               	/* frame size = 12 */
 1156               	/* stack size = 14 */
 1157               	.L__stack_usage = 14
 1158 0014 4F83      		std Y+7,r20
 1159 0016 5887      		std Y+8,r21
 1160 0018 6987      		std Y+9,r22
 1161 001a 7A87      		std Y+10,r23
 1162 001c 8B87      		std Y+11,r24
 1163 001e 9C87      		std Y+12,r25
  53:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1164               		.loc 1 53 5 view .LVU278
  53:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1165               		.loc 1 53 9 is_stmt 0 view .LVU279
 1166 0020 CE01      		movw r24,r28
 1167 0022 0796      		adiw r24,7
 1168 0024 0E94 0000 		call process_tapping
 1169               	.LVL69:
  53:tmk_core/common/action_tapping.c ****         if (!IS_NOEVENT(record.event)) {
 1170               		.loc 1 53 8 view .LVU280
 1171 0028 8823      		tst r24
 1172 002a 01F0      		breq .L134
  54:tmk_core/common/action_tapping.c ****             debug("processed: ");
 1173               		.loc 1 54 9 is_stmt 1 view .LVU281
 1174               	.LBB46:
 1175               	.LBI46:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1176               		.loc 2 48 20 view .LVU282
 1177               	.LBB47:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1178               		.loc 2 48 51 view .LVU283
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1179               		.loc 2 48 74 is_stmt 0 view .LVU284
 1180 002c 8A85      		ldd r24,Y+10
 1181 002e 9B85      		ldd r25,Y+11
 1182 0030 892B      		or r24,r25
 1183 0032 01F0      		breq .L142
 1184 0034 4F81      		ldd r20,Y+7
 1185 0036 5885      		ldd r21,Y+8
 1186 0038 842F      		mov r24,r20
 1187 003a 8523      		and r24,r21
 1188 003c 8F3F      		cpi r24,lo8(-1)
 1189 003e 01F0      		breq .+2
 1190 0040 00C0      		rjmp .L157
 1191               	.L142:
 1192               	.LBE47:
 1193               	.LBE46:
  73:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1194               		.loc 1 73 32 discriminator 1 view .LVU285
 1195 0042 8091 0000 		lds r24,waiting_buffer_tail
  73:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1196               		.loc 1 73 5 discriminator 1 view .LVU286
 1197 0046 9091 0000 		lds r25,waiting_buffer_head
 1198 004a 8913      		cpse r24,r25
 1199 004c 00C0      		rjmp .L140
 1200               	.L133:
 1201               	/* epilogue start */
  87:tmk_core/common/action_tapping.c **** 
 1202               		.loc 1 87 1 view .LVU287
 1203 004e 2C96      		adiw r28,12
 1204 0050 0FB6      		in __tmp_reg__,__SREG__
 1205 0052 F894      		cli
 1206 0054 DEBF      		out __SP_H__,r29
 1207 0056 0FBE      		out __SREG__,__tmp_reg__
 1208 0058 CDBF      		out __SP_L__,r28
 1209 005a DF91      		pop r29
 1210 005c CF91      		pop r28
 1211 005e 0895      		ret
 1212               	.L134:
  60:tmk_core/common/action_tapping.c ****             // clear all in case of overflow.
 1213               		.loc 1 60 9 is_stmt 1 view .LVU288
 1214 0060 86E0      		ldi r24,lo8(6)
 1215 0062 FE01      		movw r30,r28
 1216 0064 3796      		adiw r30,7
 1217 0066 DE01      		movw r26,r28
 1218 0068 1196      		adiw r26,1
 1219               		0:
 1220 006a 0190      		ld r0,Z+
 1221 006c 0D92      		st X+,r0
 1222 006e 8A95      		dec r24
 1223 0070 01F4      		brne 0b
 1224               	.LVL70:
 1225               	.LBB48:
 1226               	.LBI48:
 311:tmk_core/common/action_tapping.c ****     if (IS_NOEVENT(record.event)) {
 1227               		.loc 1 311 6 view .LVU289
 1228               	.LBB49:
 312:tmk_core/common/action_tapping.c ****         return true;
 1229               		.loc 1 312 5 view .LVU290
 1230               	.LBB50:
 1231               	.LBI50:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1232               		.loc 2 48 20 view .LVU291
 1233               	.LBB51:
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1234               		.loc 2 48 51 view .LVU292
  48:tmk_core/common/keyboard.h **** static inline bool IS_PRESSED(keyevent_t event) { return (!IS_NOEVENT(event) && event.pressed); }
 1235               		.loc 2 48 74 is_stmt 0 view .LVU293
 1236 0072 8A85      		ldd r24,Y+10
 1237 0074 9B85      		ldd r25,Y+11
 1238 0076 892B      		or r24,r25
 1239 0078 01F0      		breq .L142
 1240 007a 8885      		ldd r24,Y+8
 1241 007c 9F81      		ldd r25,Y+7
 1242 007e 8923      		and r24,r25
 1243 0080 8F3F      		cpi r24,lo8(-1)
 1244 0082 01F0      		breq .L142
 1245               	.LBE51:
 1246               	.LBE50:
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1247               		.loc 1 316 5 is_stmt 1 view .LVU294
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1248               		.loc 1 316 30 is_stmt 0 view .LVU295
 1249 0084 8091 0000 		lds r24,waiting_buffer_head
 1250 0088 90E0      		ldi r25,0
 1251 008a 9C01      		movw r18,r24
 1252 008c 2F5F      		subi r18,-1
 1253 008e 3F4F      		sbci r19,-1
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1254               		.loc 1 316 35 view .LVU296
 1255 0090 2770      		andi r18,7
 1256 0092 3327      		clr r19
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1257               		.loc 1 316 57 view .LVU297
 1258 0094 4091 0000 		lds r20,waiting_buffer_tail
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1259               		.loc 1 316 8 view .LVU298
 1260 0098 4217      		cp r20,r18
 1261 009a 1306      		cpc __zero_reg__,r19
 1262 009c 01F4      		brne .L159
 1263               	.LVL71:
 316:tmk_core/common/action_tapping.c ****         debug("waiting_buffer_enq: Over flow.\n");
 1264               		.loc 1 316 8 view .LVU299
 1265               	.LBE49:
 1266               	.LBE48:
  62:tmk_core/common/action_tapping.c ****             clear_keyboard();
 1267               		.loc 1 62 50 is_stmt 1 view .LVU300
  63:tmk_core/common/action_tapping.c ****             waiting_buffer_clear();
 1268               		.loc 1 63 13 view .LVU301
 1269 009e 0E94 0000 		call clear_keyboard
 1270               	.LVL72:
  64:tmk_core/common/action_tapping.c ****             tapping_key = (keyrecord_t){};
 1271               		.loc 1 64 13 view .LVU302
 1272               	.LBB53:
 1273               	.LBI53:
 333:tmk_core/common/action_tapping.c ****     waiting_buffer_head = 0;
 1274               		.loc 1 333 6 view .LVU303
 1275               	.LBB54:
 334:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1276               		.loc 1 334 5 view .LVU304
 334:tmk_core/common/action_tapping.c ****     waiting_buffer_tail = 0;
 1277               		.loc 1 334 25 is_stmt 0 view .LVU305
 1278 00a2 1092 0000 		sts waiting_buffer_head,__zero_reg__
 335:tmk_core/common/action_tapping.c **** }
 1279               		.loc 1 335 5 is_stmt 1 view .LVU306
 335:tmk_core/common/action_tapping.c **** }
 1280               		.loc 1 335 25 is_stmt 0 view .LVU307
 1281 00a6 1092 0000 		sts waiting_buffer_tail,__zero_reg__
 1282               	.LBE54:
 1283               	.LBE53:
  65:tmk_core/common/action_tapping.c ****         }
 1284               		.loc 1 65 13 is_stmt 1 view .LVU308
  65:tmk_core/common/action_tapping.c ****         }
 1285               		.loc 1 65 25 is_stmt 0 view .LVU309
 1286 00aa 86E0      		ldi r24,lo8(6)
 1287 00ac E0E0      		ldi r30,lo8(tapping_key)
 1288 00ae F0E0      		ldi r31,hi8(tapping_key)
 1289 00b0 DF01      		movw r26,r30
 1290               		0:
 1291 00b2 1D92      		st X+,__zero_reg__
 1292 00b4 8A95      		dec r24
 1293 00b6 01F4      		brne 0b
 1294 00b8 00C0      		rjmp .L142
 1295               	.LVL73:
 1296               	.L159:
 1297               	.LBB55:
 1298               	.LBB52:
 321:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1299               		.loc 1 321 5 is_stmt 1 view .LVU310
 321:tmk_core/common/action_tapping.c ****     waiting_buffer_head                 = (waiting_buffer_head + 1) % WAITING_BUFFER_SIZE;
 1300               		.loc 1 321 41 is_stmt 0 view .LVU311
 1301 00ba 66E0      		ldi r22,lo8(6)
 1302 00bc 70E0      		ldi r23,0
 1303 00be 0E94 0000 		call __mulhi3
 1304 00c2 DC01      		movw r26,r24
 1305 00c4 A050      		subi r26,lo8(-(waiting_buffer))
 1306 00c6 B040      		sbci r27,hi8(-(waiting_buffer))
 1307 00c8 96E0      		ldi r25,lo8(6)
 1308 00ca FE01      		movw r30,r28
 1309 00cc 3196      		adiw r30,1
 1310               		0:
 1311 00ce 0190      		ld r0,Z+
 1312 00d0 0D92      		st X+,r0
 1313 00d2 9A95      		dec r25
 1314 00d4 01F4      		brne 0b
 322:tmk_core/common/action_tapping.c **** 
 1315               		.loc 1 322 5 is_stmt 1 view .LVU312
 322:tmk_core/common/action_tapping.c **** 
 1316               		.loc 1 322 41 is_stmt 0 view .LVU313
 1317 00d6 2093 0000 		sts waiting_buffer_head,r18
 324:tmk_core/common/action_tapping.c ****     debug_waiting_buffer();
 1318               		.loc 1 324 34 is_stmt 1 view .LVU314
 325:tmk_core/common/action_tapping.c ****     return true;
 1319               		.loc 1 325 5 view .LVU315
 1320 00da 0E94 0000 		call debug_waiting_buffer
 1321               	.LVL74:
 326:tmk_core/common/action_tapping.c **** }
 1322               		.loc 1 326 5 view .LVU316
 326:tmk_core/common/action_tapping.c **** }
 1323               		.loc 1 326 5 is_stmt 0 view .LVU317
 1324 00de 00C0      		rjmp .L142
 1325               	.L140:
 326:tmk_core/common/action_tapping.c **** }
 1326               		.loc 1 326 5 view .LVU318
 1327               	.LBE52:
 1328               	.LBE55:
  74:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1329               		.loc 1 74 9 is_stmt 1 view .LVU319
  74:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1330               		.loc 1 74 13 is_stmt 0 view .LVU320
 1331 00e0 90E0      		ldi r25,0
 1332 00e2 66E0      		ldi r22,lo8(6)
 1333 00e4 70E0      		ldi r23,0
 1334 00e6 0E94 0000 		call __mulhi3
 1335 00ea 8050      		subi r24,lo8(-(waiting_buffer))
 1336 00ec 9040      		sbci r25,hi8(-(waiting_buffer))
 1337 00ee 0E94 0000 		call process_tapping
 1338               	.LVL75:
  74:tmk_core/common/action_tapping.c ****             debug("processed: waiting_buffer[");
 1339               		.loc 1 74 12 view .LVU321
 1340 00f2 8823      		tst r24
 1341 00f4 01F4      		brne .+2
 1342 00f6 00C0      		rjmp .L133
  75:tmk_core/common/action_tapping.c ****             debug_dec(waiting_buffer_tail);
 1343               		.loc 1 75 48 is_stmt 1 view .LVU322
  76:tmk_core/common/action_tapping.c ****             debug("] = ");
 1344               		.loc 1 76 43 view .LVU323
  77:tmk_core/common/action_tapping.c ****             debug_record(waiting_buffer[waiting_buffer_tail]);
 1345               		.loc 1 77 26 view .LVU324
  78:tmk_core/common/action_tapping.c ****             debug("\n\n");
 1346               		.loc 1 78 13 view .LVU325
 1347 00f8 8091 0000 		lds r24,waiting_buffer_tail
 1348 00fc 90E0      		ldi r25,0
 1349 00fe 66E0      		ldi r22,lo8(6)
 1350 0100 70E0      		ldi r23,0
 1351 0102 0E94 0000 		call __mulhi3
 1352 0106 FC01      		movw r30,r24
 1353 0108 E050      		subi r30,lo8(-(waiting_buffer))
 1354 010a F040      		sbci r31,hi8(-(waiting_buffer))
 1355 010c 4081      		ld r20,Z
 1356 010e 5181      		ldd r21,Z+1
 1357 0110 6281      		ldd r22,Z+2
 1358 0112 7381      		ldd r23,Z+3
 1359 0114 8481      		ldd r24,Z+4
 1360 0116 9581      		ldd r25,Z+5
 1361 0118 0E94 0000 		call debug_record
 1362               	.LVL76:
  79:tmk_core/common/action_tapping.c ****         } else {
 1363               		.loc 1 79 26 view .LVU326
  73:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1364               		.loc 1 73 99 is_stmt 0 view .LVU327
 1365 011c 8091 0000 		lds r24,waiting_buffer_tail
 1366 0120 90E0      		ldi r25,0
 1367 0122 0196      		adiw r24,1
  73:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1368               		.loc 1 73 104 view .LVU328
 1369 0124 8770      		andi r24,7
 1370 0126 9927      		clr r25
  73:tmk_core/common/action_tapping.c ****         if (process_tapping(&waiting_buffer[waiting_buffer_tail])) {
 1371               		.loc 1 73 76 view .LVU329
 1372 0128 8093 0000 		sts waiting_buffer_tail,r24
 1373 012c 00C0      		rjmp .L142
 1374               	.L157:
  55:tmk_core/common/action_tapping.c ****             debug_record(record);
 1375               		.loc 1 55 33 is_stmt 1 view .LVU330
  56:tmk_core/common/action_tapping.c ****             debug("\n");
 1376               		.loc 1 56 13 view .LVU331
 1377 012e 6985      		ldd r22,Y+9
 1378 0130 7A85      		ldd r23,Y+10
 1379 0132 8B85      		ldd r24,Y+11
 1380 0134 9C85      		ldd r25,Y+12
 1381 0136 0E94 0000 		call debug_record
 1382               	.LVL77:
 1383 013a 00C0      		rjmp .L142
 1384               		.cfi_endproc
 1385               	.LFE7:
 1387               		.section	.bss.waiting_buffer_tail,"aw",@nobits
 1390               	waiting_buffer_tail:
 1391 0000 00        		.zero	1
 1392               		.section	.bss.waiting_buffer_head,"aw",@nobits
 1395               	waiting_buffer_head:
 1396 0000 00        		.zero	1
 1397               		.section	.bss.waiting_buffer,"aw",@nobits
 1400               	waiting_buffer:
 1401 0000 0000 0000 		.zero	48
 1401      0000 0000 
 1401      0000 0000 
 1401      0000 0000 
 1401      0000 0000 
 1402               		.section	.bss.tapping_key,"aw",@nobits
 1405               	tapping_key:
 1406 0000 0000 0000 		.zero	6
 1406      0000 
 1407               		.text
 1408               	.Letext0:
 1409               		.file 3 "c:\\users\\nonej\\documents\\keyboard\\msys64\\home\\nonej\\qmk_utils\\avr8-gnu-toolchain
 1410               		.file 4 "tmk_core/common/keycode.h"
 1411               		.file 5 "tmk_core/common/action_code.h"
 1412               		.file 6 "tmk_core/common/action.h"
 1413               		.file 7 "tmk_core/common/action_layer.h"
 1414               		.file 8 "tmk_core/common/timer.h"
 1415               		.file 9 "tmk_core/common/debug.h"
DEFINED SYMBOLS
                            *ABS*:00000000 action_tapping.c
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:2      *ABS*:0000003e __SP_H__
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:3      *ABS*:0000003d __SP_L__
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:4      *ABS*:0000003f __SREG__
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:5      *ABS*:00000000 __tmp_reg__
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:6      *ABS*:00000001 __zero_reg__
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:12     .text.debug_waiting_buffer:00000000 debug_waiting_buffer
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1390   .bss.waiting_buffer_tail:00000000 waiting_buffer_tail
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1395   .bss.waiting_buffer_head:00000000 waiting_buffer_head
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1400   .bss.waiting_buffer:00000000 waiting_buffer
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:86     .text.debug_tapping_key:00000000 debug_tapping_key
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1405   .bss.tapping_key:00000000 tapping_key
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:109    .text.waiting_buffer_scan_tap:00000000 waiting_buffer_scan_tap
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:302    .text.process_tapping:00000000 process_tapping
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1107   .text.get_tapping_term:00000000 get_tapping_term
C:\Users\nonej\Documents\Keyboard\msys64\tmp\cclSigtl.s:1130   .text.action_tapping_process:00000000 action_tapping_process

UNDEFINED SYMBOLS
__mulhi3
debug_record
process_record
layer_switch_get_action
is_tap_key
debug_event
process_record_tap_hint
clear_keyboard
__do_clear_bss
